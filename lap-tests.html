<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ø§Ù„ØªØ­Ø§Ù„ÙŠÙ„ Ø§Ù„Ø·Ø¨ÙŠØ© - Ø·Ø¨ÙŠØ¨ 24/7</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=El+Messiri:wght@400;500;600;700&family=Tajawal:wght@300;400;500;700;800;900&display=swap" rel="stylesheet">
    <style>
  :root {
    --primary: #1e40af;
    --primary-dark: #1e3a8a;
    --primary-light: #dbeafe;
    --secondary: #dc2626;
    --accent: #f59e0b;
    --success: #059669;
    --warning: #d97706;
    --error: #dc2626;
    --info: #0ea5e9;
    --dark: #1e1b4b;
    --light: #f0f9ff;
    --surface: #ffffff;
    --glass: rgba(255, 255, 255, 0.25);
    --glass-dark: rgba(255, 255, 255, 0.1);
    --text-primary: #1e293b;
    --text-secondary: #475569;
    --text-light: #64748b;
    --gradient-primary: linear-gradient(135deg, #1e40af 0%, #3730a3 100%);
    --gradient-hospital: linear-gradient(135deg, #1e40af 0%, #dc2626 100%);
    --gradient-premium: linear-gradient(135deg, #1e40af 0%, #3730a3 50%, #7c3aed 100%);
    --gradient-lab: linear-gradient(135deg, #0ea5e9 0%, #3b82f6 100%);
    --shadow-soft: 0 8px 32px rgba(0, 0, 0, 0.1);
    --shadow-glass: 0 8px 32px rgba(30, 64, 175, 0.2);
    --shadow-card: 0 4px 24px rgba(0, 0, 0, 0.08);
    --shadow-large: 0 16px 48px rgba(0, 0, 0, 0.15);
    --radius-xl: 24px;
    --radius-lg: 20px;
    --radius-md: 16px;
    --radius-sm: 12px;
    --transition-smooth: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
    --transition-bounce: all 0.6s cubic-bezier(0.68, -0.55, 0.265, 1.55);
}

* {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
    font-family: 'Tajawal', 'El Messiri', sans-serif;
    -webkit-tap-highlight-color: transparent;
}

body {
    background: linear-gradient(135deg, #f0f9ff 0%, #e0f2fe 50%, #dbeafe 100%);
    color: var(--text-primary);
    direction: rtl;
    overflow-x: hidden;
    min-height: 100vh;
}

/* ØªØµÙ…ÙŠÙ… Ø´Ø±ÙŠØ· Ø§Ù„Ø­Ø§Ù„Ø© Ø§Ù„Ù…ØªÙ…ÙŠØ² */
.status-bar {
    background: transparent;
    color: var(--text-primary);
    padding: 12px 20px;
    display: flex;
    justify-content: space-between;
    align-items: center;
    font-size: 14px;
    font-weight: 500;
    backdrop-filter: blur(20px);
    position: relative;
    z-index: 1000;
}

.status-bar::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: var(--glass);
    backdrop-filter: blur(20px);
    z-index: -1;
}

/* Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ */
.premium-app {
    max-width: 428px;
    margin: 0 auto;
    background: transparent;
    min-height: 100vh;
    position: relative;
    overflow: hidden;
}

/* Ø§Ù„Ø®Ù„ÙÙŠØ© Ø§Ù„Ø¯ÙŠÙ†Ø§Ù…ÙŠÙƒÙŠØ© */
.background-effects {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    z-index: -1;
    pointer-events: none;
}

.floating-shapes {
    position: absolute;
    width: 100%;
    height: 100%;
}

.shape {
    position: absolute;
    border-radius: 50%;
    background: var(--gradient-primary);
    opacity: 0.1;
    animation: float 6s ease-in-out infinite;
}

.shape:nth-child(1) {
    width: 200px;
    height: 200px;
    top: 10%;
    left: 10%;
    animation-delay: 0s;
}

.shape:nth-child(2) {
    width: 150px;
    height: 150px;
    top: 60%;
    right: 20%;
    animation-delay: 2s;
}

.shape:nth-child(3) {
    width: 100px;
    height: 100px;
    bottom: 20%;
    left: 20%;
    animation-delay: 4s;
}

@keyframes float {
    0%, 100% { transform: translateY(0px) rotate(0deg); }
    50% { transform: translateY(-20px) rotate(180deg); }
}

/* Ø§Ù„Ù‡ÙŠØ¯Ø± Ø§Ù„Ù…ØªÙ‚Ø¯Ù… */
.lab-header {
    background: var(--gradient-lab);
    color: white;
    padding: 40px 24px 30px;
    border-radius: 0 0 var(--radius-xl) var(--radius-xl);
    box-shadow: var(--shadow-glass);
    position: relative;
    overflow: hidden;
}

.header-background {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1000 1000"><polygon fill="rgba(255,255,255,0.05)" points="0,1000 1000,0 1000,1000"/></svg>');
    background-size: cover;
}

.header-content {
    position: relative;
    z-index: 2;
    text-align: center;
}

.header-title {
    font-size: 28px;
    font-weight: 800;
    margin-bottom: 8px;
    background: linear-gradient(45deg, #fff, #dbeafe);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
}

.header-subtitle {
    font-size: 16px;
    opacity: 0.9;
    margin-bottom: 25px;
}

.quick-stats {
    display: grid;
    grid-template-columns: repeat(3, 1fr);
    gap: 15px;
    margin-top: 20px;
}

.stat-item {
    background: rgba(255, 255, 255, 0.15);
    backdrop-filter: blur(10px);
    border-radius: var(--radius-md);
    padding: 15px;
    text-align: center;
    border: 1px solid rgba(255, 255, 255, 0.2);
}

.stat-value {
    font-size: 20px;
    font-weight: 800;
    margin-bottom: 4px;
}

.stat-label {
    font-size: 12px;
    opacity: 0.9;
}

/* Ø§Ù„Ù…Ø­ØªÙˆÙ‰ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ */
.lab-content {
    padding: 25px 20px;
    padding-bottom: 120px;
}

.section-title {
    font-size: 20px;
    font-weight: 800;
    margin: 30px 0 20px;
    color: var(--text-primary);
    display: flex;
    align-items: center;
    gap: 12px;
    padding-right: 8px;
}

.section-title::before {
    content: '';
    width: 4px;
    height: 24px;
    background: var(--gradient-lab);
    border-radius: 2px;
}

/* Ø§Ù„Ø¨Ø­Ø« Ø§Ù„Ù…ØªÙ‚Ø¯Ù… */
.search-section {
    background: var(--surface);
    border-radius: var(--radius-lg);
    padding: 25px;
    box-shadow: var(--shadow-card);
    margin-bottom: 25px;
    border: 1px solid #f1f5f9;
}

.search-container {
    position: relative;
    margin-bottom: 20px;
}

.search-input {
    width: 100%;
    padding: 15px 50px 15px 15px;
    border: 2px solid #e2e8f0;
    border-radius: var(--radius-md);
    font-size: 16px;
    transition: var(--transition-smooth);
}

.search-input:focus {
    border-color: var(--primary);
    outline: none;
    box-shadow: 0 0 0 3px rgba(30, 64, 175, 0.1);
}

.search-icon {
    position: absolute;
    left: 15px;
    top: 50%;
    transform: translateY(-50%);
    color: var(--text-secondary);
}

.search-filters {
    display: grid;
    grid-template-columns: repeat(2, 1fr);
    gap: 12px;
}

.filter-select {
    padding: 12px;
    border: 2px solid #e2e8f0;
    border-radius: var(--radius-md);
    font-size: 14px;
    background: white;
    cursor: pointer;
    transition: var(--transition-smooth);
}

.filter-select:focus {
    border-color: var(--primary);
    outline: none;
}

/* Ø§Ù„ÙØ¦Ø§Øª Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ© */
.categories-section {
    background: var(--surface);
    border-radius: var(--radius-lg);
    padding: 25px;
    box-shadow: var(--shadow-card);
    margin-bottom: 25px;
    border: 1px solid #f1f5f9;
}

.categories-grid {
    display: grid;
    grid-template-columns: repeat(3, 1fr);
    gap: 15px;
    margin-top: 20px;
}

.category-card {
    background: #f8fafc;
    border: 2px solid #e2e8f0;
    border-radius: var(--radius-md);
    padding: 20px 12px;
    text-align: center;
    cursor: pointer;
    transition: var(--transition-bounce);
    position: relative;
    overflow: hidden;
}

.category-card::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 3px;
    background: var(--gradient-lab);
    transform: scaleX(0);
    transition: var(--transition-smooth);
}

.category-card:hover {
    border-color: var(--primary);
    transform: translateY(-5px);
    box-shadow: var(--shadow-soft);
}

.category-card:hover::before {
    transform: scaleX(1);
}

.category-card.active {
    background: var(--primary-light);
    border-color: var(--primary);
}

.category-card.active::before {
    transform: scaleX(1);
}

.category-icon {
    width: 50px;
    height: 50px;
    border-radius: var(--radius-md);
    background: var(--gradient-lab);
    display: flex;
    align-items: center;
    justify-content: center;
    margin: 0 auto 12px;
    font-size: 20px;
    color: white;
    transition: var(--transition-smooth);
}

.category-card:hover .category-icon {
    transform: scale(1.1) rotate(5deg);
}

.category-name {
    font-weight: 700;
    font-size: 13px;
    margin-bottom: 6px;
    color: var(--text-primary);
}

.category-count {
    font-size: 11px;
    color: var(--text-secondary);
}

/* Ø§Ù„ØªØ­Ø§Ù„ÙŠÙ„ Ø§Ù„Ù…ÙˆØµÙ‰ Ø¨Ù‡Ø§ */
.recommended-section {
    background: var(--surface);
    border-radius: var(--radius-lg);
    padding: 25px;
    box-shadow: var(--shadow-card);
    margin-bottom: 25px;
    border: 1px solid #f1f5f9;
}

.tests-grid {
    display: grid;
    grid-template-columns: repeat(2, 1fr);
    gap: 15px;
    margin-top: 20px;
}

.test-card {
    background: #f8fafc;
    border: 2px solid #e2e8f0;
    border-radius: var(--radius-lg);
    padding: 20px;
    cursor: pointer;
    transition: var(--transition-bounce);
    position: relative;
    overflow: hidden;
}

.test-card::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 3px;
    background: var(--gradient-lab);
    transform: scaleX(0);
    transition: var(--transition-smooth);
}

.test-card:hover {
    border-color: var(--primary);
    transform: translateY(-5px);
    box-shadow: var(--shadow-soft);
}

.test-card:hover::before {
    transform: scaleX(1);
}

.test-card.recommended {
    border-color: var(--accent);
    background: linear-gradient(135deg, #fef3c7 0%, #fde68a 100%);
}

.test-card.recommended::before {
    background: var(--accent);
}

.test-header {
    display: flex;
    justify-content: space-between;
    align-items: flex-start;
    margin-bottom: 12px;
}

.test-icon {
    width: 40px;
    height: 40px;
    border-radius: var(--radius-md);
    background: var(--gradient-lab);
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 16px;
    color: white;
    flex-shrink: 0;
}

.test-badge {
    background: var(--accent);
    color: white;
    padding: 4px 8px;
    border-radius: 12px;
    font-size: 10px;
    font-weight: 700;
}

.test-name {
    font-weight: 800;
    font-size: 15px;
    margin-bottom: 6px;
    color: var(--text-primary);
}

.test-description {
    font-size: 12px;
    color: var(--text-secondary);
    margin-bottom: 12px;
    line-height: 1.4;
}

.test-meta {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-top: 15px;
}

.test-price {
    font-weight: 800;
    font-size: 16px;
    color: var(--primary);
}

.test-duration {
    font-size: 11px;
    color: var(--text-secondary);
    display: flex;
    align-items: center;
    gap: 4px;
}

/* Ø¬Ù…ÙŠØ¹ Ø§Ù„ØªØ­Ø§Ù„ÙŠÙ„ */
.all-tests-section {
    background: var(--surface);
    border-radius: var(--radius-lg);
    padding: 25px;
    box-shadow: var(--shadow-card);
    margin-bottom: 25px;
    border: 1px solid #f1f5f9;
}

.tests-list {
    display: flex;
    flex-direction: column;
    gap: 12px;
    margin-top: 20px;
}

.test-item {
    background: #f8fafc;
    border: 2px solid #e2e8f0;
    border-radius: var(--radius-md);
    padding: 18px;
    display: flex;
    align-items: center;
    gap: 15px;
    cursor: pointer;
    transition: var(--transition-smooth);
    position: relative;
}

.test-item:hover {
    border-color: var(--primary);
    transform: translateX(-5px);
    box-shadow: var(--shadow-soft);
}

.test-item-icon {
    width: 45px;
    height: 45px;
    border-radius: var(--radius-md);
    background: var(--gradient-lab);
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 18px;
    color: white;
    flex-shrink: 0;
}

.test-item-info {
    flex: 1;
}

.test-item-name {
    font-weight: 700;
    font-size: 14px;
    margin-bottom: 4px;
    color: var(--text-primary);
}

.test-item-category {
    font-size: 12px;
    color: var(--text-secondary);
    margin-bottom: 6px;
}

.test-item-features {
    display: flex;
    gap: 8px;
    flex-wrap: wrap;
}

.feature-tag {
    background: var(--primary-light);
    color: var(--primary);
    padding: 3px 8px;
    border-radius: 10px;
    font-size: 10px;
    font-weight: 600;
}

.test-item-price {
    font-weight: 800;
    font-size: 15px;
    color: var(--primary);
    text-align: left;
    min-width: 70px;
}

/* Ø§Ù„Ù…Ø®ØªØ¨Ø±Ø§Øª */
.labs-section {
    background: var(--surface);
    border-radius: var(--radius-lg);
    padding: 25px;
    box-shadow: var(--shadow-card);
    margin-bottom: 25px;
    border: 1px solid #f1f5f9;
}

.labs-grid {
    display: grid;
    grid-template-columns: 1fr;
    gap: 15px;
    margin-top: 20px;
}

.lab-card {
    background: #f8fafc;
    border: 2px solid #e2e8f0;
    border-radius: var(--radius-lg);
    padding: 20px;
    display: flex;
    gap: 15px;
    cursor: pointer;
    transition: var(--transition-bounce);
    position: relative;
}

.lab-card:hover {
    border-color: var(--primary);
    transform: translateX(-8px);
    box-shadow: var(--shadow-soft);
}

.lab-card.featured {
    border-color: var(--accent);
    background: linear-gradient(135deg, #fef3c7 0%, #fde68a 100%);
}

.lab-avatar {
    width: 70px;
    height: 70px;
    border-radius: var(--radius-md);
    background: var(--gradient-lab);
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 24px;
    color: white;
    flex-shrink: 0;
}

.lab-info {
    flex: 1;
}

.lab-name {
    font-weight: 800;
    font-size: 16px;
    margin-bottom: 6px;
}

.lab-specialty {
    font-size: 14px;
    color: var(--text-secondary);
    margin-bottom: 8px;
}

.lab-rating {
    display: flex;
    align-items: center;
    gap: 8px;
    margin-bottom: 8px;
}

.stars {
    color: #f59e0b;
}

.rating-value {
    font-weight: 700;
    font-size: 14px;
}

.rating-count {
    font-size: 12px;
    color: var(--text-secondary);
}

.lab-features {
    display: flex;
    gap: 10px;
    flex-wrap: wrap;
    margin-top: 10px;
}

.lab-actions {
    display: flex;
    flex-direction: column;
    gap: 8px;
    justify-content: center;
}

.book-btn {
    background: var(--gradient-lab);
    color: white;
    border: none;
    padding: 8px 12px;
    border-radius: var(--radius-md);
    font-size: 12px;
    font-weight: 700;
    cursor: pointer;
    transition: var(--transition-smooth);
}

.book-btn:hover {
    transform: translateY(-2px);
}

.lab-distance {
    font-size: 12px;
    color: var(--text-secondary);
    text-align: center;
}

/* Ø§Ù„Ø­Ø¬ÙˆØ²Ø§Øª */
.bookings-section {
    background: var(--surface);
    border-radius: var(--radius-lg);
    padding: 25px;
    box-shadow: var(--shadow-card);
    margin-bottom: 25px;
    border: 1px solid #f1f5f9;
}

.bookings-list {
    display: flex;
    flex-direction: column;
    gap: 12px;
    margin-top: 20px;
}

.booking-item {
    background: #f8fafc;
    border: 2px solid #e2e8f0;
    border-radius: var(--radius-md);
    padding: 18px;
    display: flex;
    align-items: center;
    gap: 15px;
    cursor: pointer;
    transition: var(--transition-smooth);
    position: relative;
}

.booking-item:hover {
    border-color: var(--primary);
    transform: translateX(-5px);
    box-shadow: var(--shadow-soft);
}

.booking-status {
    position: absolute;
    top: 15px;
    left: 15px;
    padding: 4px 8px;
    border-radius: 12px;
    font-size: 10px;
    font-weight: 700;
    color: white;
}

.status-pending { background: var(--warning); }
.status-confirmed { background: var(--success); }
-status-completed { background: var(--info); }
.status-cancelled { background: var(--error); }

.booking-icon {
    width: 45px;
    height: 45px;
    border-radius: var(--radius-md);
    background: var(--gradient-lab);
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 18px;
    color: white;
    flex-shrink: 0;
}

.booking-info {
    flex: 1;
}

.booking-test {
    font-weight: 700;
    font-size: 14px;
    margin-bottom: 4px;
}

.booking-lab {
    font-size: 12px;
    color: var(--text-secondary);
    margin-bottom: 6px;
}

.booking-date {
    font-size: 11px;
    color: var(--text-light);
}

.booking-actions {
    display: flex;
    flex-direction: column;
    gap: 6px;
}

.action-btn {
    background: var(--light);
    border: 1px solid #e2e8f0;
    padding: 6px 12px;
    border-radius: var(--radius-sm);
    font-size: 11px;
    font-weight: 600;
    cursor: pointer;
    transition: var(--transition-smooth);
}

.action-btn:hover {
    background: var(--primary-light);
    color: var(--primary);
}

.action-btn.primary {
    background: var(--primary);
    color: white;
}

.action-btn.primary:hover {
    background: var(--primary-dark);
}

/* Ø§Ù„Ù†ÙˆØ§ÙØ° Ø§Ù„Ù…Ù†Ø¨Ø«Ù‚Ø© */
.modal {
    display: none;
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0, 0, 0, 0.8);
    backdrop-filter: blur(10px);
    z-index: 2000;
    align-items: center;
    justify-content: center;
    padding: 20px;
}

.modal-content {
    background: white;
    border-radius: var(--radius-xl);
    padding: 30px;
    max-width: 400px;
    width: 100%;
    box-shadow: var(--shadow-large);
    animation: modalAppear 0.5s cubic-bezier(0.4, 0, 0.2, 1);
    max-height: 90vh;
    overflow-y: auto;
}

@keyframes modalAppear {
    from {
        opacity: 0;
        transform: scale(0.8) translateY(50px);
    }
    to {
        opacity: 1;
        transform: scale(1) translateY(0);
    }
}

.modal-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 25px;
    padding-bottom: 15px;
    border-bottom: 2px solid #f1f5f9;
}

.modal-title {
    font-size: 22px;
    font-weight: 800;
    color: var(--text-primary);
}

.close-modal {
    background: none;
    border: none;
    font-size: 24px;
    cursor: pointer;
    color: var(--text-secondary);
    transition: var(--transition-smooth);
}

.close-modal:hover {
    color: var(--error);
    transform: rotate(90deg);
}

.form-group {
    margin-bottom: 20px;
}

.form-label {
    display: block;
    margin-bottom: 8px;
    font-weight: 700;
    color: var(--text-primary);
    font-size: 14px;
}

.form-input, .form-select, .form-textarea {
    width: 100%;
    padding: 14px 16px;
    border: 2px solid #e2e8f0;
    border-radius: var(--radius-md);
    font-size: 16px;
    transition: var(--transition-smooth);
    background: white;
    font-family: 'Tajawal', sans-serif;
}

.form-input:focus, .form-select:focus, .form-textarea:focus {
    border-color: var(--primary);
    outline: none;
    box-shadow: 0 0 0 3px rgba(30, 64, 175, 0.1);
}

.form-textarea {
    resize: vertical;
    min-height: 100px;
}

.form-row {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 15px;
}

.form-actions {
    display: flex;
    gap: 12px;
    margin-top: 30px;
}

.btn {
    padding: 14px 24px;
    border: none;
    border-radius: var(--radius-md);
    font-weight: 800;
    cursor: pointer;
    transition: var(--transition-bounce);
    flex: 1;
    font-size: 15px;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 8px;
}

.btn-primary {
    background: var(--gradient-lab);
    color: white;
}

.btn-secondary {
    background: var(--light);
    color: var(--text-primary);
    border: 2px solid #e2e8f0;
}

.btn:hover {
    transform: translateY(-2px);
    box-shadow: var(--shadow-soft);
}

.btn:active {
    transform: translateY(0);
}

/* ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ø­Ø¬Ø² */
.booking-summary {
    background: #f8fafc;
    border-radius: var(--radius-lg);
    padding: 20px;
    margin: 20px 0;
    border: 2px solid #e2e8f0;
}

.summary-item {
    display: flex;
    justify-content: space-between;
    padding: 10px 0;
    border-bottom: 1px solid #e2e8f0;
}

.summary-item:last-child {
    border-bottom: none;
}

.summary-label {
    font-weight: 600;
    color: var(--text-secondary);
}

.summary-value {
    font-weight: 700;
    color: var(--text-primary);
}

.booking-number {
    background: var(--primary-light);
    color: var(--primary);
    padding: 8px 16px;
    border-radius: var(--radius-md);
    font-family: monospace;
    font-weight: 700;
    text-align: center;
    margin: 15px 0;
}

/* Ø´Ø±ÙŠØ· Ø§Ù„ØªÙ†Ù‚Ù„ Ø§Ù„Ø³ÙÙ„ÙŠ */
.bottom-nav-premium {
    position: fixed;
    bottom: 20px;
    left: 50%;
    transform: translateX(-50%);
    background: var(--glass);
    backdrop-filter: blur(20px);
    border: 1px solid rgba(255, 255, 255, 0.2);
    display: flex;
    padding: 15px;
    border-radius: var(--radius-xl);
    box-shadow: var(--shadow-soft);
    z-index: 1000;
    max-width: 380px;
    width: calc(100% - 40px);
}

.nav-item-premium {
    display: flex;
    flex-direction: column;
    align-items: center;
    padding: 10px 12px;
    border-radius: var(--radius-md);
    transition: var(--transition-bounce);
    flex: 1;
    position: relative;
    text-decoration: none;
    color: inherit;
}

.nav-item-premium.active {
    background: var(--gradient-lab);
    color: white;
    transform: translateY(-10px);
}

.nav-item-premium.active .nav-label {
    color: white;
}

.nav-item-premium.active::before {
    content: '';
    position: absolute;
    top: -8px;
    width: 20px;
    height: 3px;
    background: var(--gradient-lab);
    border-radius: 2px;
}

.nav-icon-premium {
    font-size: 20px;
    margin-bottom: 6px;
    transition: var(--transition-smooth);
}

.nav-item-premium.active .nav-icon-premium {
    transform: scale(1.2);
}

.nav-label {
    font-size: 11px;
    font-weight: 700;
    color: var(--text-secondary);
}

/* Ø§Ù„ØªØ­Ù…ÙŠÙ„ ÙˆØ§Ù„Ø­Ø±ÙƒØ§Øª */
.loading {
    display: inline-block;
    width: 20px;
    height: 20px;
    border: 3px solid rgba(255, 255, 255, 0.3);
    border-radius: 50%;
    border-top-color: white;
    animation: spin 1s ease-in-out infinite;
}

@keyframes spin {
    to { transform: rotate(360deg); }
}

.pulse {
    animation: pulse 2s infinite;
}

@keyframes pulse {
    0% { transform: scale(1); }
    50% { transform: scale(1.05); }
    100% { transform: scale(1); }
}

/* Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±Ø§Øª */
.notification {
    position: fixed;
    top: 20px;
    left: 50%;
    transform: translateX(-50%);
    background: var(--success);
    color: white;
    padding: 16px 24px;
    border-radius: var(--radius-lg);
    box-shadow: var(--shadow-large);
    z-index: 3000;
    font-weight: 700;
    display: flex;
    align-items: center;
    gap: 12px;
    animation: slideDown 0.3s ease-out;
}

.notification.error {
    background: var(--error);
}

.notification.warning {
    background: var(--warning);
}

.notification.info {
    background: var(--info);
}

@keyframes slideDown {
    from {
        opacity: 0;
        transform: translateX(-50%) translateY(-50px);
    }
    to {
        opacity: 1;
        transform: translateX(-50%) translateY(0);
    }
}

/* Ù†ØªØ§Ø¦Ø¬ Ø§Ù„ØªØ­Ø§Ù„ÙŠÙ„ */
.results-container {
    background: #f8fafc;
    border-radius: var(--radius-lg);
    padding: 20px;
    margin: 20px 0;
    border: 2px solid #e2e8f0;
}

.result-item {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 12px 0;
    border-bottom: 1px solid #e2e8f0;
}

.result-item:last-child {
    border-bottom: none;
}

.result-name {
    font-weight: 600;
    color: var(--text-primary);
    flex: 1;
}

.result-value {
    font-weight: 700;
    margin: 0 15px;
    min-width: 60px;
    text-align: center;
}

.result-normal { color: var(--success); }
.result-warning { color: var(--warning); }
.result-danger { color: var(--error); }

.result-range {
    font-size: 12px;
    color: var(--text-secondary);
    min-width: 100px;
    text-align: left;
}

.result-status {
    padding: 4px 8px;
    border-radius: 12px;
    font-size: 10px;
    font-weight: 700;
    color: white;
    min-width: 60px;
    text-align: center;
}

.status-normal { background: var(--success); }
.status-warning { background: var(--warning); }
.status-danger { background: var(--error); }

/* Ø§Ù„ØªÙƒÙŠÙ Ù…Ø¹ Ø§Ù„Ø´Ø§Ø´Ø§Øª */
@media (max-width: 428px) {
    .categories-grid {
        grid-template-columns: repeat(2, 1fr);
    }
    
    .tests-grid {
        grid-template-columns: 1fr;
    }
    
    .search-filters {
        grid-template-columns: 1fr;
    }
    
    .form-row {
        grid-template-columns: 1fr;
    }
    
    .lab-card {
        flex-direction: column;
        text-align: center;
    }
    
    .lab-actions {
        flex-direction: row;
        justify-content: center;
    }
    
    .test-item {
        flex-direction: column;
        text-align: center;
        gap: 10px;
    }
    
    .test-item-price {
        text-align: center;
    }
}
</style>
</head>
<body>
    <!-- ØªØ£Ø«ÙŠØ±Ø§Øª Ø§Ù„Ø®Ù„ÙÙŠØ© Ø§Ù„Ø¯ÙŠÙ†Ø§Ù…ÙŠÙƒÙŠØ© -->
    <div class="background-effects">
        <div class="floating-shapes">
            <div class="shape"></div>
            <div class="shape"></div>
            <div class="shape"></div>
        </div>
    </div>

    <!-- Ø´Ø±ÙŠØ· Ø§Ù„Ø­Ø§Ù„Ø© -->
    <div class="status-bar">
        <div class="status-left">
            <span id="currentTime">2:45</span>
        </div>
        <div class="status-right">
            <i class="fas fa-signal"></i>
            <i class="fas fa-wifi"></i>
            <i class="fas fa-battery-three-quarters"></i>
        </div>
    </div>

    <!-- Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ -->
    <div class="premium-app">
        <!-- Ø§Ù„Ù‡ÙŠØ¯Ø± -->
        <div class="lab-header">
            <div class="header-background"></div>
            <div class="header-content">
                <h1 class="header-title">Ø§Ù„ØªØ­Ø§Ù„ÙŠÙ„ Ø§Ù„Ø·Ø¨ÙŠØ©</h1>
                <p class="header-subtitle">Ø®Ø¯Ù…Ø§Øª ØªØ­Ø§Ù„ÙŠÙ„ Ø·Ø¨ÙŠØ© Ø¯Ù‚ÙŠÙ‚Ø© ÙˆØ³Ø±ÙŠØ¹Ø© ÙÙŠ Ù…Ø®ØªØ¨Ø±Ø§Øª Ù…Ø¹ØªÙ…Ø¯Ø©</p>
                
                <div class="quick-stats">
                    <div class="stat-item">
                        <div class="stat-value">50+</div>
                        <div class="stat-label">Ù†ÙˆØ¹ ØªØ­Ù„ÙŠÙ„</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value">25</div>
                        <div class="stat-label">Ù…Ø®ØªØ¨Ø± Ù…Ø¹ØªÙ…Ø¯</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value">4.9</div>
                        <div class="stat-label">ØªÙ‚ÙŠÙŠÙ… Ø§Ù„Ø®Ø¯Ù…Ø©</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Ø§Ù„Ù…Ø­ØªÙˆÙ‰ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ -->
        <div class="lab-content">
            <!-- Ø§Ù„Ø¨Ø­Ø« Ø§Ù„Ø³Ø±ÙŠØ¹ -->
            <div class="section-title">Ø§Ù„Ø¨Ø­Ø« Ø§Ù„Ø³Ø±ÙŠØ¹</div>
            <div class="search-section">
                <div class="search-container">
                    <input type="text" class="search-input" id="testSearch" placeholder="Ø§Ø¨Ø­Ø« Ø¹Ù† ØªØ­Ù„ÙŠÙ„ Ø£Ùˆ Ù…Ø®ØªØ¨Ø±...">
                    <i class="fas fa-search search-icon"></i>
                </div>
                <div class="search-filters">
                    <select class="filter-select" id="categoryFilter">
                        <option value="">Ø¬Ù…ÙŠØ¹ Ø§Ù„ÙØ¦Ø§Øª</option>
                        <option value="blood">ØªØ­Ø§Ù„ÙŠÙ„ Ø§Ù„Ø¯Ù…</option>
                        <option value="urine">ØªØ­Ø§Ù„ÙŠÙ„ Ø§Ù„Ø¨ÙˆÙ„</option>
                        <option value="hormones">Ø§Ù„Ù‡Ø±Ù…ÙˆÙ†Ø§Øª</option>
                        <option value="vitamins">Ø§Ù„ÙÙŠØªØ§Ù…ÙŠÙ†Ø§Øª</option>
                        <option value="liver">ÙˆØ¸Ø§Ø¦Ù Ø§Ù„ÙƒØ¨Ø¯</option>
                        <option value="kidney">ÙˆØ¸Ø§Ø¦Ù Ø§Ù„ÙƒÙ„Ù‰</option>
                    </select>
                    <select class="filter-select" id="urgencyFilter">
                        <option value="">Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø®Ø¯Ù…Ø§Øª</option>
                        <option value="fast">Ù†ØªØ§Ø¦Ø¬ Ø³Ø±ÙŠØ¹Ø©</option>
                        <option value="home">Ø®Ø¯Ù…Ø© Ù…Ù†Ø²Ù„ÙŠØ©</option>
                        <option value="express">Ù†ØªØ§Ø¦Ø¬ Ø¹Ø§Ø¬Ù„Ø©</option>
                    </select>
                </div>
            </div>

            <!-- Ø§Ù„ÙØ¦Ø§Øª Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ© -->
            <div class="section-title">ÙØ¦Ø§Øª Ø§Ù„ØªØ­Ø§Ù„ÙŠÙ„</div>
            <div class="categories-section">
                <div class="categories-grid" id="categoriesGrid">
                    <!-- Ø³ÙŠØªÙ… ØªØ¹Ø¨Ø¦ØªÙ‡Ø§ Ø¨Ø§Ù„Ø¬Ø§ÙØ§Ø³ÙƒØ±Ø¨Øª -->
                </div>
            </div>

            <!-- Ø§Ù„ØªØ­Ø§Ù„ÙŠÙ„ Ø§Ù„Ù…ÙˆØµÙ‰ Ø¨Ù‡Ø§ -->
            <div class="section-title">ØªØ­Ø§Ù„ÙŠÙ„ Ù…ÙˆØµÙ‰ Ø¨Ù‡Ø§</div>
            <div class="recommended-section">
                <div class="tests-grid" id="recommendedTests">
                    <!-- Ø³ÙŠØªÙ… ØªØ¹Ø¨Ø¦ØªÙ‡Ø§ Ø¨Ø§Ù„Ø¬Ø§ÙØ§Ø³ÙƒØ±Ø¨Øª -->
                </div>
            </div>

            <!-- Ø¬Ù…ÙŠØ¹ Ø§Ù„ØªØ­Ø§Ù„ÙŠÙ„ -->
            <div class="section-title">Ø¬Ù…ÙŠØ¹ Ø§Ù„ØªØ­Ø§Ù„ÙŠÙ„</div>
            <div class="all-tests-section">
                <div class="tests-list" id="allTestsList">
                    <!-- Ø³ÙŠØªÙ… ØªØ¹Ø¨Ø¦ØªÙ‡Ø§ Ø¨Ø§Ù„Ø¬Ø§ÙØ§Ø³ÙƒØ±Ø¨Øª -->
                </div>
            </div>

            <!-- Ø§Ù„Ù…Ø®ØªØ¨Ø±Ø§Øª Ø§Ù„Ù…ØªØ¹Ø§Ù‚Ø¯ Ù…Ø¹Ù‡Ø§ -->
            <div class="section-title">Ø§Ù„Ù…Ø®ØªØ¨Ø±Ø§Øª Ø§Ù„Ù…Ø¹ØªÙ…Ø¯Ø©</div>
            <div class="labs-section">
                <div class="labs-grid" id="labsGrid">
                    <!-- Ø³ÙŠØªÙ… ØªØ¹Ø¨Ø¦ØªÙ‡Ø§ Ø¨Ø§Ù„Ø¬Ø§ÙØ§Ø³ÙƒØ±Ø¨Øª -->
                </div>
            </div>

            <!-- Ø­Ø¬ÙˆØ²Ø§ØªÙŠ -->
            <div class="section-title">Ø­Ø¬ÙˆØ²Ø§ØªÙŠ Ø§Ù„Ø³Ø§Ø¨Ù‚Ø©</div>
            <div class="bookings-section">
                <div class="bookings-list" id="bookingsList">
                    <!-- Ø³ÙŠØªÙ… ØªØ¹Ø¨Ø¦ØªÙ‡Ø§ Ø¨Ø§Ù„Ø¬Ø§ÙØ§Ø³ÙƒØ±Ø¨Øª -->
                </div>
            </div>
        </div>

        <!-- Ù†ÙˆØ§ÙØ° Ù…Ù†Ø¨Ø«Ù‚Ø© -->
        
        <!-- Ù†Ø§ÙØ°Ø© ØªÙØ§ØµÙŠÙ„ Ø§Ù„ØªØ­Ù„ÙŠÙ„ -->
        <div id="testDetailsModal" class="modal">
            <div class="modal-content">
                <!-- Ø³ÙŠØªÙ… ØªØ¹Ø¨Ø¦ØªÙ‡Ø§ Ø¨Ø§Ù„Ø¬Ø§ÙØ§Ø³ÙƒØ±Ø¨Øª -->
            </div>
        </div>

        <!-- Ù†Ø§ÙØ°Ø© Ø­Ø¬Ø² ØªØ­Ù„ÙŠÙ„ -->
        <div id="bookTestModal" class="modal">
            <div class="modal-content">
                <!-- Ø³ÙŠØªÙ… ØªØ¹Ø¨Ø¦ØªÙ‡Ø§ Ø¨Ø§Ù„Ø¬Ø§ÙØ§Ø³ÙƒØ±Ø¨Øª -->
            </div>
        </div>

        <!-- Ù†Ø§ÙØ°Ø© ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø­Ø¬Ø² -->
        <div id="confirmationModal" class="modal">
            <div class="modal-content">
                <!-- Ø³ÙŠØªÙ… ØªØ¹Ø¨Ø¦ØªÙ‡Ø§ Ø¨Ø§Ù„Ø¬Ø§ÙØ§Ø³ÙƒØ±Ø¨Øª -->
            </div>
        </div>

        <!-- Ù†Ø§ÙØ°Ø© Ø§Ù„Ù†ØªØ§Ø¦Ø¬ -->
        <div id="resultsModal" class="modal">
            <div class="modal-content">
                <!-- Ø³ÙŠØªÙ… ØªØ¹Ø¨Ø¦ØªÙ‡Ø§ Ø¨Ø§Ù„Ø¬Ø§ÙØ§Ø³ÙƒØ±Ø¨Øª -->
            </div>
        </div>

        <!-- Ø´Ø±ÙŠØ· Ø§Ù„ØªÙ†Ù‚Ù„ Ø§Ù„Ø³ÙÙ„ÙŠ -->
        <div class="bottom-nav-premium">
            <a href="index.html" class="nav-item-premium">
                <div class="nav-icon-premium">
                    <i class="fas fa-home"></i>
                </div>
                <div class="nav-label">Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</div>
            </a>
            <a href="consultation.html" class="nav-item-premium">
                <div class="nav-icon-premium">
                    <i class="fas fa-stethoscope"></i>
                </div>
                <div class="nav-label">Ø§Ù„Ø§Ø³ØªØ´Ø§Ø±Ø§Øª</div>
            </a>
            <a href="lab-tests.html" class="nav-item-premium active">
                <div class="nav-icon-premium">
                    <i class="fas fa-flask"></i>
                </div>
                <div class="nav-label">Ø§Ù„ØªØ­Ø§Ù„ÙŠÙ„</div>
            </a>
            <a href="wallet.html" class="nav-item-premium">
                <div class="nav-icon-premium">
                    <i class="fas fa-wallet"></i>
                </div>
                <div class="nav-label">Ø§Ù„Ù…Ø§Ù„</div>
            </a>
            <a href="profile.html" class="nav-item-premium">
                <div class="nav-icon-premium">
                    <i class="fas fa-user"></i>
                </div>
                <div class="nav-label">Ø­Ø³Ø§Ø¨ÙŠ</div>
            </a>
        </div>
    </div>

<script>
// Ù†Ø¸Ø§Ù… Ø§Ù„ØªØ­Ø§Ù„ÙŠÙ„ Ø§Ù„Ø·Ø¨ÙŠØ© Ø§Ù„Ù…ØªÙƒØ§Ù…Ù„
class AdvancedLabSystem {
    constructor() {
        this.categories = [];
        this.tests = [];
        this.labs = [];
        this.userBookings = JSON.parse(localStorage.getItem('labBookings')) || [];
        this.userResults = JSON.parse(localStorage.getItem('labResults')) || [];
        this.currentBooking = null;
        this.selectedTests = [];
        this.init();
    }

    init() {
        this.loadCategories();
        this.loadTests();
        this.loadLabs();
        this.setupEventListeners();
        this.updateTime();
        this.loadUserData();
        setInterval(() => this.updateTime(), 60000);
    }

    setupEventListeners() {
        // Ø§Ù„Ø¨Ø­Ø« ÙÙŠ Ø§Ù„ÙˆÙ‚Øª Ø§Ù„Ø­Ù‚ÙŠÙ‚ÙŠ
        const testSearch = document.getElementById('testSearch');
        if (testSearch) {
            testSearch.addEventListener('input', (e) => {
                this.handleSearch(e.target.value);
            });
        }

        // Ø§Ù„ÙÙ„Ø§ØªØ±
        const categoryFilter = document.getElementById('categoryFilter');
        if (categoryFilter) {
            categoryFilter.addEventListener('change', () => {
                this.applyFilters();
            });
        }

        const urgencyFilter = document.getElementById('urgencyFilter');
        if (urgencyFilter) {
            urgencyFilter.addEventListener('change', () => {
                this.applyFilters();
            });
        }

        // Ø¥ØºÙ„Ø§Ù‚ Ø§Ù„Ù†ÙˆØ§ÙØ°
        document.addEventListener('click', (event) => {
            if (event.target.classList.contains('modal')) {
                this.closeModal(event.target.id);
            }
        });

        // Ù…Ù†Ø¹ Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ù†Ù…Ø§Ø°Ø¬
        document.querySelectorAll('form').forEach(form => {
            form.addEventListener('submit', (e) => e.preventDefault());
        });
    }

    loadUserData() {
        this.userAccount = JSON.parse(localStorage.getItem('financialAccount'));
    }

    loadCategories() {
        this.categories = [
            {
                id: 1,
                name: 'ØªØ­Ø§Ù„ÙŠÙ„ Ø§Ù„Ø¯Ù…',
                icon: 'fa-tint',
                testCount: 25,
                color: '#ef4444',
                description: 'ÙØ­Øµ Ù…ÙƒÙˆÙ†Ø§Øª Ø§Ù„Ø¯Ù… ÙˆØ§Ù„ÙƒØ´Ù Ø¹Ù† Ø§Ù„Ø£Ù…Ø±Ø§Ø¶'
            },
            {
                id: 2,
                name: 'ØªØ­Ø§Ù„ÙŠÙ„ Ø§Ù„Ø¨ÙˆÙ„',
                icon: 'fa-flask',
                testCount: 15,
                color: '#3b82f6',
                description: 'ÙØ­Øµ ÙˆØ¸Ø§Ø¦Ù Ø§Ù„ÙƒÙ„Ù‰ ÙˆØ§Ù„Ù…Ø³Ø§Ù„Ùƒ Ø§Ù„Ø¨ÙˆÙ„ÙŠØ©'
            },
            {
                id: 3,
                name: 'Ø§Ù„Ù‡Ø±Ù…ÙˆÙ†Ø§Øª',
                icon: 'fa-chart-line',
                testCount: 20,
                color: '#8b5cf6',
                description: 'Ù‚ÙŠØ§Ø³ Ù…Ø³ØªÙˆÙ‰ Ø§Ù„Ù‡Ø±Ù…ÙˆÙ†Ø§Øª ÙÙŠ Ø§Ù„Ø¬Ø³Ù…'
            },
            {
                id: 4,
                name: 'Ø§Ù„ÙÙŠØªØ§Ù…ÙŠÙ†Ø§Øª',
                icon: 'fa-apple-alt',
                testCount: 12,
                color: '#f59e0b',
                description: 'ÙØ­Øµ Ù†Ù‚Øµ Ø§Ù„ÙÙŠØªØ§Ù…ÙŠÙ†Ø§Øª ÙˆØ§Ù„Ù…Ø¹Ø§Ø¯Ù†'
            },
            {
                id: 5,
                name: 'ÙˆØ¸Ø§Ø¦Ù Ø§Ù„ÙƒØ¨Ø¯',
                icon: 'fa-liver',
                testCount: 8,
                color: '#10b981',
                description: 'ÙØ­Øµ Ø¥Ù†Ø²ÙŠÙ…Ø§Øª ÙˆÙˆØ¸Ø§Ø¦Ù Ø§Ù„ÙƒØ¨Ø¯'
            },
            {
                id: 6,
                name: 'ÙˆØ¸Ø§Ø¦Ù Ø§Ù„ÙƒÙ„Ù‰',
                icon: 'fa-kidneys',
                testCount: 10,
                color: '#06b6d4',
                description: 'ÙØ­Øµ ÙƒÙØ§Ø¡Ø© Ø¹Ù…Ù„ Ø§Ù„ÙƒÙ„Ù‰'
            },
            {
                id: 7,
                name: 'Ø§Ù„Ø¯Ù‡ÙˆÙ†',
                icon: 'fa-chart-pie',
                testCount: 6,
                color: '#ec4899',
                description: 'Ù‚ÙŠØ§Ø³ Ù…Ø³ØªÙˆÙ‰ Ø§Ù„Ø¯Ù‡ÙˆÙ† ÙÙŠ Ø§Ù„Ø¯Ù…'
            },
            {
                id: 8,
                name: 'Ø³ÙƒØ± Ø§Ù„Ø¯Ù…',
                icon: 'fa-syringe',
                testCount: 8,
                color: '#84cc16',
                description: 'Ù…Ø±Ø§Ù‚Ø¨Ø© Ù…Ø³ØªÙˆÙ‰ Ø§Ù„Ø³ÙƒØ± ÙÙŠ Ø§Ù„Ø¯Ù…'
            }
        ];
        this.renderCategories();
    }

    loadTests() {
        this.tests = [
            {
                id: 1,
                name: 'ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ø¯Ù… Ø§Ù„Ø´Ø§Ù…Ù„',
                category: 'blood',
                categoryId: 1,
                description: 'ÙØ­Øµ Ø´Ø§Ù…Ù„ Ù„Ù…ÙƒÙˆÙ†Ø§Øª Ø§Ù„Ø¯Ù… Ø¨Ù…Ø§ ÙÙŠ Ø°Ù„Ùƒ Ø®Ù„Ø§ÙŠØ§ Ø§Ù„Ø¯Ù… Ø§Ù„Ø­Ù…Ø±Ø§Ø¡ ÙˆØ§Ù„Ø¨ÙŠØ¶Ø§Ø¡ ÙˆØ§Ù„ØµÙØ§Ø¦Ø­ Ø§Ù„Ø¯Ù…ÙˆÙŠØ©',
                price: 80,
                duration: '24 Ø³Ø§Ø¹Ø©',
                preparation: 'Ø§Ù„ØµÙŠØ§Ù… 8-12 Ø³Ø§Ø¹Ø©',
                features: ['Ù†ØªØ§Ø¦Ø¬ Ø¯Ù‚ÙŠÙ‚Ø©', 'ØªØ­Ù„ÙŠÙ„ Ù…ÙØµÙ„', 'ØªÙ‚Ø±ÙŠØ± Ø·Ø¨ÙŠ'],
                icon: 'fa-tint',
                isRecommended: true,
                normalRange: 'Ø±Ø§Ø¬Ø¹ Ø§Ù„ØªÙ‚Ø±ÙŠØ±',
                sampleType: 'Ø¯Ù…'
            },
            {
                id: 2,
                name: 'ØªØ­Ù„ÙŠÙ„ ÙˆØ¸Ø§Ø¦Ù Ø§Ù„ÙƒØ¨Ø¯',
                category: 'liver',
                categoryId: 5,
                description: 'Ù‚ÙŠØ§Ø³ Ø¥Ù†Ø²ÙŠÙ…Ø§Øª Ø§Ù„ÙƒØ¨Ø¯ ÙˆØ§Ù„Ø¨Ø±ÙˆØªÙŠÙ†Ø§Øª Ù„ØªÙ‚ÙŠÙŠÙ… ØµØ­Ø© Ø§Ù„ÙƒØ¨Ø¯',
                price: 120,
                duration: '48 Ø³Ø§Ø¹Ø©',
                preparation: 'Ø§Ù„ØµÙŠØ§Ù… 8 Ø³Ø§Ø¹Ø§Øª',
                features: ['ALT', 'AST', 'Bilirubin'],
                icon: 'fa-liver',
                isRecommended: true,
                normalRange: 'Ø±Ø§Ø¬Ø¹ Ø§Ù„ØªÙ‚Ø±ÙŠØ±',
                sampleType: 'Ø¯Ù…'
            },
            {
                id: 3,
                name: 'ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ø³ÙƒØ± Ø§Ù„ØªØ±Ø§ÙƒÙ…ÙŠ',
                category: 'blood',
                categoryId: 1,
                description: 'Ù‚ÙŠØ§Ø³ Ù…ØªÙˆØ³Ø· Ù…Ø³ØªÙˆÙ‰ Ø§Ù„Ø³ÙƒØ± ÙÙŠ Ø§Ù„Ø¯Ù… Ø®Ù„Ø§Ù„ Ø§Ù„Ø´Ù‡Ø±ÙŠÙ† Ø§Ù„Ù…Ø§Ø¶ÙŠÙŠÙ†',
                price: 60,
                duration: '24 Ø³Ø§Ø¹Ø©',
                preparation: 'Ù„Ø§ ÙŠØ­ØªØ§Ø¬ ØµÙŠØ§Ù…',
                features: ['Ø¯Ù‚Ø© Ø¹Ø§Ù„ÙŠØ©', 'Ù…Ø¤Ø´Ø± Ù„Ù„Ø³ÙƒØ±ÙŠ'],
                icon: 'fa-syringe',
                isRecommended: false,
                normalRange: 'Ø£Ù‚Ù„ Ù…Ù† 5.7%',
                sampleType: 'Ø¯Ù…'
            },
            {
                id: 4,
                name: 'ØªØ­Ù„ÙŠÙ„ ÙÙŠØªØ§Ù…ÙŠÙ† Ø¯',
                category: 'vitamins',
                categoryId: 4,
                description: 'Ù‚ÙŠØ§Ø³ Ù…Ø³ØªÙˆÙ‰ ÙÙŠØªØ§Ù…ÙŠÙ† Ø¯ ÙÙŠ Ø§Ù„Ø¯Ù… Ù„Ù„ÙƒØ´Ù Ø¹Ù† Ø§Ù„Ù†Ù‚Øµ',
                price: 90,
                duration: '72 Ø³Ø§Ø¹Ø©',
                preparation: 'Ù„Ø§ ÙŠØ­ØªØ§Ø¬ ØµÙŠØ§Ù…',
                features: ['Ù†ØªØ§Ø¦Ø¬ Ø¯Ù‚ÙŠÙ‚Ø©', 'ØªÙˆØµÙŠØ§Øª Ø¹Ù„Ø§Ø¬ÙŠØ©'],
                icon: 'fa-sun',
                isRecommended: true,
                normalRange: '30-100 Ù†Ø§Ù†ÙˆØºØ±Ø§Ù…/Ù…Ù„',
                sampleType: 'Ø¯Ù…'
            },
            {
                id: 5,
                name: 'ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ø¨ÙˆÙ„ Ø§Ù„ÙƒØ§Ù…Ù„',
                category: 'urine',
                categoryId: 2,
                description: 'ÙØ­Øµ Ø´Ø§Ù…Ù„ Ù„Ù„Ø¨ÙˆÙ„ Ù„Ù„ÙƒØ´Ù Ø¹Ù† Ø§Ù„Ø£Ù…Ø±Ø§Ø¶ ÙˆØ§Ù„Ø§Ù„ØªÙ‡Ø§Ø¨Ø§Øª',
                price: 40,
                duration: '24 Ø³Ø§Ø¹Ø©',
                preparation: 'Ø¹ÙŠÙ†Ø© Ø¨ÙˆÙ„ ØµØ¨Ø§Ø­ÙŠØ©',
                features: ['ÙØ­Øµ ÙƒÙŠÙ…ÙŠØ§Ø¦ÙŠ', 'ÙØ­Øµ Ù…Ø¬Ù‡Ø±ÙŠ'],
                icon: 'fa-flask',
                isRecommended: false,
                normalRange: 'Ø±Ø§Ø¬Ø¹ Ø§Ù„ØªÙ‚Ø±ÙŠØ±',
                sampleType: 'Ø¨ÙˆÙ„'
            },
            {
                id: 6,
                name: 'ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ù‡Ø±Ù…ÙˆÙ†Ø§Øª',
                category: 'hormones',
                categoryId: 3,
                description: 'Ù‚ÙŠØ§Ø³ Ù…Ø³ØªÙˆÙ‰ Ø§Ù„Ù‡Ø±Ù…ÙˆÙ†Ø§Øª Ø§Ù„Ù…Ø®ØªÙ„ÙØ© ÙÙŠ Ø§Ù„Ø¬Ø³Ù…',
                price: 150,
                duration: '72 Ø³Ø§Ø¹Ø©',
                preparation: 'Ø­Ø³Ø¨ Ù†ÙˆØ¹ Ø§Ù„Ù‡Ø±Ù…ÙˆÙ†',
                features: ['TSH', 'Testosterone', 'Estrogen'],
                icon: 'fa-chart-line',
                isRecommended: false,
                normalRange: 'Ø­Ø³Ø¨ Ø§Ù„Ø¬Ù†Ø³ ÙˆØ§Ù„Ø¹Ù…Ø±',
                sampleType: 'Ø¯Ù…'
            },
            {
                id: 7,
                name: 'ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ø¯Ù‡ÙˆÙ†',
                category: 'blood',
                categoryId: 1,
                description: 'Ù‚ÙŠØ§Ø³ Ù…Ø³ØªÙˆÙ‰ Ø§Ù„ÙƒÙˆÙ„ÙŠØ³ØªØ±ÙˆÙ„ ÙˆØ§Ù„Ø¯Ù‡ÙˆÙ† ÙÙŠ Ø§Ù„Ø¯Ù…',
                price: 70,
                duration: '24 Ø³Ø§Ø¹Ø©',
                preparation: 'Ø§Ù„ØµÙŠØ§Ù… 12 Ø³Ø§Ø¹Ø©',
                features: ['Ø§Ù„ÙƒÙˆÙ„ÙŠØ³ØªØ±ÙˆÙ„', 'Ø§Ù„Ø¯Ù‡ÙˆÙ† Ø§Ù„Ø«Ù„Ø§Ø«ÙŠØ©'],
                icon: 'fa-chart-pie',
                isRecommended: true,
                normalRange: 'Ø±Ø§Ø¬Ø¹ Ø§Ù„ØªÙ‚Ø±ÙŠØ±',
                sampleType: 'Ø¯Ù…'
            },
            {
                id: 8,
                name: 'ØªØ­Ù„ÙŠÙ„ ÙˆØ¸Ø§Ø¦Ù Ø§Ù„ÙƒÙ„Ù‰',
                category: 'kidney',
                categoryId: 6,
                description: 'ÙØ­Øµ ÙƒÙØ§Ø¡Ø© Ø§Ù„ÙƒÙ„Ù‰ ÙˆÙ‚ÙŠØ§Ø³ Ù†Ø³Ø¨Ø© Ø§Ù„ÙŠÙˆØ±ÙŠØ§ ÙˆØ§Ù„ÙƒØ±ÙŠØ§ØªÙŠÙ†ÙŠÙ†',
                price: 85,
                duration: '24 Ø³Ø§Ø¹Ø©',
                preparation: 'Ù„Ø§ ÙŠØ­ØªØ§Ø¬ ØµÙŠØ§Ù…',
                features: ['Creatinine', 'Urea', 'GFR'],
                icon: 'fa-kidneys',
                isRecommended: false,
                normalRange: 'Ø±Ø§Ø¬Ø¹ Ø§Ù„ØªÙ‚Ø±ÙŠØ±',
                sampleType: 'Ø¯Ù…'
            }
        ];
        this.renderRecommendedTests();
        this.renderAllTests();
    }

    loadLabs() {
        this.labs = [
            {
                id: 1,
                name: 'Ù…Ø®ØªØ¨Ø± Ø§Ù„Ø£Ù…Ù„ Ø§Ù„Ù…ØªÙ‚Ø¯Ù…',
                specialty: 'Ù…Ø®ØªØ¨Ø± ØªØ­Ø§Ù„ÙŠÙ„ Ø·Ø¨ÙŠØ© Ø´Ø§Ù…Ù„Ø©',
                rating: 4.8,
                ratingCount: 234,
                distance: '2.5 ÙƒÙ…',
                features: ['Ø®Ø¯Ù…Ø© Ù…Ù†Ø²Ù„ÙŠØ©', 'Ù†ØªØ§Ø¦Ø¬ Ø³Ø±ÙŠØ¹Ø©', 'Ù…Ø®ØªØ¨Ø± Ù…Ø¹ØªÙ…Ø¯'],
                image: 'ğŸ¥',
                priceRange: 'Ø§Ù‚ØªØµØ§Ø¯ÙŠ',
                workingHours: '24/7',
                address: 'Ø´Ø§Ø±Ø¹ Ø§Ù„Ù…Ù„Ùƒ ÙÙ‡Ø¯ØŒ Ø§Ù„Ø±ÙŠØ§Ø¶',
                phone: '0112345678'
            },
            {
                id: 2,
                name: 'Ù…Ø®ØªØ¨Ø± Ø§Ù„Ù†Ø®Ø¨Ø© Ø§Ù„Ø·Ø¨ÙŠ',
                specialty: 'ØªØ­Ø§Ù„ÙŠÙ„ Ù…ØªØ®ØµØµØ© ÙˆØ¯Ù‚ÙŠÙ‚Ø©',
                rating: 4.9,
                ratingCount: 189,
                distance: '3.2 ÙƒÙ…',
                features: ['Ù†ØªØ§Ø¦Ø¬ Ø¹Ø§Ø¬Ù„Ø©', 'Ø£Ø¬Ù‡Ø²Ø© Ø­Ø¯ÙŠØ«Ø©', 'Ø·Ø§Ù‚Ù… Ù…ØªØ®ØµØµ'],
                image: 'ğŸ”¬',
                priceRange: 'Ù…ØªÙˆØ³Ø·',
                workingHours: '6:00 Øµ - 12:00 Ù…',
                address: 'Ø­ÙŠ Ø§Ù„Ø¹Ù„ÙŠØ§ØŒ Ø§Ù„Ø±ÙŠØ§Ø¶',
                phone: '0118765432'
            },
            {
                id: 3,
                name: 'Ù…Ø®ØªØ¨Ø± Ø§Ù„ØµØ­Ø© ÙˆØ§Ù„Ø¬ÙˆØ¯Ø©',
                specialty: 'ØªØ­Ø§Ù„ÙŠÙ„ Ø·Ø¨ÙŠØ© Ø³Ø±ÙŠØ¹Ø©',
                rating: 4.7,
                ratingCount: 156,
                distance: '1.8 ÙƒÙ…',
                features: ['Ø®Ø¯Ù…Ø© Ù…Ù†Ø²Ù„ÙŠØ©', 'Ø£Ø³Ø¹Ø§Ø± ØªÙ†Ø§ÙØ³ÙŠØ©', 'Ù†ØªØ§Ø¦Ø¬ Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠØ©'],
                image: 'ğŸ’Š',
                priceRange: 'Ø§Ù‚ØªØµØ§Ø¯ÙŠ',
                workingHours: '24/7',
                address: 'Ø­ÙŠ Ø§Ù„Ù†Ø®ÙŠÙ„ØŒ Ø§Ù„Ø±ÙŠØ§Ø¶',
                phone: '0115554444'
            },
            {
                id: 4,
                name: 'Ù…Ø®ØªØ¨Ø± Ø¯Ù‚ÙŠÙ‚ Ø§Ù„Ù…ØªÙ‚Ø¯Ù…',
                specialty: 'ØªØ­Ø§Ù„ÙŠÙ„ Ø¯Ù‚ÙŠÙ‚Ø© ÙˆÙ…ØªØ·ÙˆØ±Ø©',
                rating: 4.6,
                ratingCount: 98,
                distance: '4.1 ÙƒÙ…',
                features: ['ØªØ­Ø§Ù„ÙŠÙ„ Ù†Ø§Ø¯Ø±Ø©', 'Ø¯Ù‚Ø© Ø¹Ø§Ù„ÙŠØ©', 'Ø§Ø³ØªØ´Ø§Ø±Ø§Øª Ø·Ø¨ÙŠØ©'],
                image: 'ğŸ§ª',
                priceRange: 'Ù…ØªÙ…ÙŠØ²',
                workingHours: '8:00 Øµ - 10:00 Ù…',
                address: 'Ø­ÙŠ Ø§Ù„Ø³Ù„ÙŠÙ…Ø§Ù†ÙŠØ©ØŒ Ø§Ù„Ø±ÙŠØ§Ø¶',
                phone: '0113332222'
            }
        ];
        this.renderLabs();
    }

    renderCategories() {
        const container = document.getElementById('categoriesGrid');
        if (!container) return;

        container.innerHTML = '';

        this.categories.forEach(category => {
            const categoryElement = document.createElement('div');
            categoryElement.className = 'category-card';
            categoryElement.onclick = () => this.filterByCategory(category.id);
            categoryElement.title = category.description;
            
            categoryElement.innerHTML = `
                <div class="category-icon" style="background: ${category.color}">
                    <i class="fas ${category.icon}"></i>
                </div>
                <div class="category-name">${category.name}</div>
                <div class="category-count">${category.testCount} ØªØ­Ù„ÙŠÙ„</div>
            `;
            
            container.appendChild(categoryElement);
        });
    }

    renderRecommendedTests() {
        const container = document.getElementById('recommendedTests');
        if (!container) return;

        const recommendedTests = this.tests.filter(test => test.isRecommended);

        if (recommendedTests.length === 0) {
            container.innerHTML = `
                <div style="text-align: center; padding: 40px; color: var(--text-secondary);">
                    <i class="fas fa-flask" style="font-size: 48px; margin-bottom: 16px;"></i>
                    <div>Ù„Ø§ ØªÙˆØ¬Ø¯ ØªØ­Ø§Ù„ÙŠÙ„ Ù…ÙˆØµÙ‰ Ø¨Ù‡Ø§</div>
                </div>
            `;
            return;
        }

        container.innerHTML = '';

        recommendedTests.forEach(test => {
            const testElement = document.createElement('div');
            testElement.className = 'test-card recommended';
            testElement.onclick = () => this.showTestDetails(test);
            
            testElement.innerHTML = `
                <div class="test-header">
                    <div class="test-icon">
                        <i class="fas ${test.icon}"></i>
                    </div>
                    <div class="test-badge">Ù…ÙˆØµÙ‰ Ø¨Ù‡</div>
                </div>
                <div class="test-name">${test.name}</div>
                <div class="test-description">${test.description}</div>
                <div class="test-meta">
                    <div class="test-price">${test.price} Ø±.ÙŠ</div>
                    <div class="test-duration">
                        <i class="fas fa-clock"></i>
                        ${test.duration}
                    </div>
                </div>
            `;
            
            container.appendChild(testElement);
        });
    }

    renderAllTests() {
        const container = document.getElementById('allTestsList');
        if (!container) return;

        if (this.tests.length === 0) {
            container.innerHTML = `
                <div style="text-align: center; padding: 40px; color: var(--text-secondary);">
                    <i class="fas fa-flask" style="font-size: 48px; margin-bottom: 16px;"></i>
                    <div>Ù„Ø§ ØªÙˆØ¬Ø¯ ØªØ­Ø§Ù„ÙŠÙ„ Ù…ØªØ§Ø­Ø©</div>
                </div>
            `;
            return;
        }

        container.innerHTML = '';

        this.tests.forEach(test => {
            const category = this.categories.find(cat => cat.id === test.categoryId);
            
            const testElement = document.createElement('div');
            testElement.className = 'test-item';
            testElement.onclick = () => this.showTestDetails(test);
            
            testElement.innerHTML = `
                <div class="test-item-icon">
                    <i class="fas ${test.icon}"></i>
                </div>
                <div class="test-item-info">
                    <div class="test-item-name">${test.name}</div>
                    <div class="test-item-category">${category ? category.name : test.category}</div>
                    <div class="test-item-features">
                        ${test.features.map(feature => `<span class="feature-tag">${feature}</span>`).join('')}
                    </div>
                </div>
                <div class="test-item-price">${test.price} Ø±.ÙŠ</div>
            `;
            
            container.appendChild(testElement);
        });
    }

    renderLabs() {
        const container = document.getElementById('labsGrid');
        if (!container) return;

        if (this.labs.length === 0) {
            container.innerHTML = `
                <div style="text-align: center; padding: 40px; color: var(--text-secondary);">
                    <i class="fas fa-hospital" style="font-size: 48px; margin-bottom: 16px;"></i>
                    <div>Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…Ø®ØªØ¨Ø±Ø§Øª Ù…ØªØ§Ø­Ø©</div>
                </div>
            `;
            return;
        }

        container.innerHTML = '';

        this.labs.forEach((lab, index) => {
            const labElement = document.createElement('div');
            labElement.className = `lab-card ${index === 0 ? 'featured' : ''}`;
            labElement.onclick = () => this.showLabDetails(lab);
            
            const stars = this.generateStars(lab.rating);
            
            labElement.innerHTML = `
                <div class="lab-avatar">
                    ${lab.image}
                </div>
                <div class="lab-info">
                    <div class="lab-name">${lab.name}</div>
                    <div class="lab-specialty">${lab.specialty}</div>
                    <div class="lab-rating">
                        <div class="stars">${stars}</div>
                        <div class="rating-value">${lab.rating}</div>
                        <div class="rating-count">(${lab.ratingCount})</div>
                    </div>
                    <div class="lab-features">
                        ${lab.features.map(feature => `<span class="feature-tag">${feature}</span>`).join('')}
                    </div>
                </div>
                <div class="lab-actions">
                    <button class="book-btn" onclick="event.stopPropagation(); labSystem.selectLab(${lab.id})">
                        <i class="fas fa-calendar-plus"></i>
                        Ø§Ø­Ø¬Ø² Ø§Ù„Ø¢Ù†
                    </button>
                    <div class="lab-distance">${lab.distance}</div>
                </div>
            `;
            
            container.appendChild(labElement);
        });
    }

    renderBookings() {
        const container = document.getElementById('bookingsList');
        if (!container) return;

        if (this.userBookings.length === 0) {
            container.innerHTML = `
                <div style="text-align: center; padding: 40px; color: var(--text-secondary);">
                    <i class="fas fa-calendar" style="font-size: 48px; margin-bottom: 16px;"></i>
                    <div>Ù„Ø§ ØªÙˆØ¬Ø¯ Ø­Ø¬ÙˆØ²Ø§Øª Ø³Ø§Ø¨Ù‚Ø©</div>
                    <p style="font-size: 14px; margin-top: 8px;">ÙŠÙ…ÙƒÙ†Ùƒ Ø­Ø¬Ø² ØªØ­Ø§Ù„ÙŠÙ„Ùƒ Ø§Ù„Ø·Ø¨ÙŠØ© Ø§Ù„Ø¢Ù†</p>
                </div>
            `;
            return;
        }

        container.innerHTML = '';

        this.userBookings.forEach(booking => {
            const bookingElement = document.createElement('div');
            bookingElement.className = 'booking-item';
            bookingElement.onclick = () => this.showBookingDetails(booking);
            
            const statusText = this.getStatusText(booking.status);
            const statusClass = `status-${booking.status}`;
            
            bookingElement.innerHTML = `
                <div class="booking-status ${statusClass}">${statusText}</div>
                <div class="booking-icon">
                    <i class="fas fa-flask"></i>
                </div>
                <div class="booking-info">
                    <div class="booking-test">${booking.testName}</div>
                    <div class="booking-lab">${booking.labName}</div>
                    <div class="booking-date">${booking.date} - ${booking.time}</div>
                </div>
                <div class="booking-actions">
                    ${booking.status === 'completed' ? 
                        `<button class="action-btn primary" onclick="event.stopPropagation(); labSystem.showResults('${booking.id}')">
                            Ø§Ù„Ù†ØªØ§Ø¦Ø¬
                        </button>` : ''
                    }
                    ${booking.status === 'pending' ? 
                        `<button class="action-btn" onclick="event.stopPropagation(); labSystem.cancelBooking('${booking.id}')">
                            Ø¥Ù„ØºØ§Ø¡
                        </button>` : ''
                    }
                </div>
            `;
            
            container.appendChild(bookingElement);
        });
    }

    generateStars(rating) {
        const fullStars = Math.floor(rating);
        const halfStar = rating % 1 >= 0.5;
        const emptyStars = 5 - fullStars - (halfStar ? 1 : 0);
        
        let stars = '';
        
        for (let i = 0; i < fullStars; i++) {
            stars += '<i class="fas fa-star"></i>';
        }
        
        if (halfStar) {
            stars += '<i class="fas fa-star-half-alt"></i>';
        }
        
        for (let i = 0; i < emptyStars; i++) {
            stars += '<i class="far fa-star"></i>';
        }
        
        return stars;
    }

    getStatusText(status) {
        const statusMap = {
            'pending': 'Ù‚ÙŠØ¯ Ø§Ù„Ø§Ù†ØªØ¸Ø§Ø±',
            'confirmed': 'Ù…Ø¤ÙƒØ¯',
            'completed': 'Ù…ÙƒØªÙ…Ù„',
            'cancelled': 'Ù…Ù„ØºÙ‰'
        };
        return statusMap[status] || status;
    }

    handleSearch(query) {
        if (query.length >= 2) {
            const filteredTests = this.tests.filter(test => 
                test.name.includes(query) || 
                test.description.includes(query) ||
                test.category.includes(query)
            );
            this.renderFilteredTests(filteredTests);
        } else if (query.length === 0) {
            this.renderAllTests();
        }
    }

    applyFilters() {
        const category = document.getElementById('categoryFilter').value;
        const urgency = document.getElementById('urgencyFilter').value;
        
        let filteredTests = this.tests;
        
        if (category) {
            filteredTests = filteredTests.filter(test => test.category === category);
        }
        
        if (urgency) {
            // ØªØ·Ø¨ÙŠÙ‚ ÙÙ„Ø§ØªØ± Ø¥Ø¶Ø§ÙÙŠØ© Ø­Ø³Ø¨ Ù†ÙˆØ¹ Ø§Ù„Ø®Ø¯Ù…Ø©
            if (urgency === 'fast') {
                filteredTests = filteredTests.filter(test => test.duration.includes('24'));
            } else if (urgency === 'home') {
                filteredTests = filteredTests.filter(test => test.features.includes('Ø®Ø¯Ù…Ø© Ù…Ù†Ø²Ù„ÙŠØ©'));
            }
        }
        
        this.renderFilteredTests(filteredTests);
    }

    renderFilteredTests(filteredTests) {
        const container = document.getElementById('allTestsList');
        if (!container) return;

        if (filteredTests.length === 0) {
            container.innerHTML = `
                <div style="text-align: center; padding: 40px; color: var(--text-secondary);">
                    <i class="fas fa-search" style="font-size: 48px; margin-bottom: 16px;"></i>
                    <div>Ù„Ø§ ØªÙˆØ¬Ø¯ Ù†ØªØ§Ø¦Ø¬</div>
                    <p style="font-size: 14px; margin-top: 8px;">Ø¬Ø±Ø¨ ØªØºÙŠÙŠØ± Ù…Ø¹Ø§ÙŠÙŠØ± Ø§Ù„Ø¨Ø­Ø«</p>
                </div>
            `;
            return;
        }

        container.innerHTML = '';

        filteredTests.forEach(test => {
            const category = this.categories.find(cat => cat.id === test.categoryId);
            
            const testElement = document.createElement('div');
            testElement.className = 'test-item';
            testElement.onclick = () => this.showTestDetails(test);
            
            testElement.innerHTML = `
                <div class="test-item-icon">
                    <i class="fas ${test.icon}"></i>
                </div>
                <div class="test-item-info">
                    <div class="test-item-name">${test.name}</div>
                    <div class="test-item-category">${category ? category.name : test.category}</div>
                    <div class="test-item-features">
                        ${test.features.map(feature => `<span class="feature-tag">${feature}</span>`).join('')}
                    </div>
                </div>
                <div class="test-item-price">${test.price} Ø±.ÙŠ</div>
            `;
            
            container.appendChild(testElement);
        });
    }

    filterByCategory(categoryId) {
        const category = this.categories.find(cat => cat.id === categoryId);
        const filteredTests = this.tests.filter(test => test.categoryId === categoryId);
        
        this.renderFilteredTests(filteredTests);
        
        // ØªØ­Ø¯ÙŠØ« Ø­Ø§Ù„Ø© Ø§Ù„ØªØ®ØµØµ Ø§Ù„Ù†Ø´Ø·
        document.querySelectorAll('.category-card').forEach(card => {
            card.classList.remove('active');
        });
        event.target.closest('.category-card').classList.add('active');
        
        this.showNotification(`ØªÙ… Ø¹Ø±Ø¶ ØªØ­Ø§Ù„ÙŠÙ„ ${category.name}`, 'info');
    }

    showTestDetails(test) {
        const category = this.categories.find(cat => cat.id === test.categoryId);
        
        const modalContent = `
            <div class="modal-header">
                <div class="modal-title">ØªÙØ§ØµÙŠÙ„ Ø§Ù„ØªØ­Ù„ÙŠÙ„</div>
                <button class="close-modal" onclick="labSystem.closeModal('testDetailsModal')">Ã—</button>
            </div>
            <div style="text-align: center; padding: 20px 0;">
                <div class="test-icon" style="width: 80px; height: 80px; font-size: 32px; margin: 0 auto 20px;">
                    <i class="fas ${test.icon}"></i>
                </div>
                <h3 style="margin-bottom: 10px;">${test.name}</h3>
                <p style="color: var(--text-secondary); margin-bottom: 20px;">${category ? category.name : test.category}</p>
            </div>
            
            <div style="background: #f8fafc; border-radius: var(--radius-md); padding: 20px; margin: 20px 0;">
                <h4 style="margin-bottom: 15px; color: var(--text-primary);">Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„ØªØ­Ù„ÙŠÙ„</h4>
                <div style="text-align: right; line-height: 2;">
                    <p><strong>Ø§Ù„ÙˆØµÙ:</strong> ${test.description}</p>
                    <p><strong>Ù†ÙˆØ¹ Ø§Ù„Ø¹ÙŠÙ†Ø©:</strong> ${test.sampleType}</p>
                    <p><strong>Ù…Ø¯Ø© Ø§Ù„Ø§Ù†ØªØ¸Ø§Ø±:</strong> ${test.duration}</p>
                    <p><strong>Ø§Ù„ØªØ¬Ù‡ÙŠØ²:</strong> ${test.preparation}</p>
                    <p><strong>Ø§Ù„Ù…Ø¹Ø¯Ù„ Ø§Ù„Ø·Ø¨ÙŠØ¹ÙŠ:</strong> ${test.normalRange}</p>
                </div>
            </div>
            
            <div style="background: #f8fafc; border-radius: var(--radius-md); padding: 20px; margin: 20px 0;">
                <h4 style="margin-bottom: 15px; color: var(--text-primary);">Ø§Ù„Ù…Ù…ÙŠØ²Ø§Øª</h4>
                <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 10px;">
                    ${test.features.map(feature => `
                        <div style="display: flex; align-items: center; gap: 8px; padding: 8px; background: white; border-radius: var(--radius-sm);">
                            <i class="fas fa-check" style="color: var(--success);"></i>
                            <span>${feature}</span>
                        </div>
                    `).join('')}
                </div>
            </div>
            
            <div class="form-actions">
                <button class="btn btn-secondary" onclick="labSystem.closeModal('testDetailsModal')">
                    <i class="fas fa-times"></i>
                    Ø¥ØºÙ„Ø§Ù‚
                </button>
                <button class="btn btn-primary" onclick="labSystem.closeModal('testDetailsModal'); labSystem.addToCart(${test.id})">
                    <i class="fas fa-cart-plus"></i>
                    Ø¥Ø¶Ø§ÙØ© Ù„Ù„Ø­Ø¬Ø²
                </button>
            </div>
        `;

        document.getElementById('testDetailsModal').querySelector('.modal-content').innerHTML = modalContent;
        this.openModal('testDetailsModal');
    }

    showLabDetails(lab) {
        const stars = this.generateStars(lab.rating);
        
        const modalContent = `
            <div class="modal-header">
                <div class="modal-title">ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ù…Ø®ØªØ¨Ø±</div>
                <button class="close-modal" onclick="labSystem.closeModal('labDetailsModal')">Ã—</button>
            </div>
            <div style="text-align: center; padding: 20px 0;">
                <div class="lab-avatar" style="width: 100px; height: 100px; font-size: 40px; margin: 0 auto 20px;">
                    ${lab.image}
                </div>
                <h3 style="margin-bottom: 10px;">${lab.name}</h3>
                <p style="color: var(--text-secondary); margin-bottom: 20px;">${lab.specialty}</p>
                
                <div class="lab-rating" style="justify-content: center; margin-bottom: 20px;">
                    <div class="stars">${stars}</div>
                    <div class="rating-value">${lab.rating}</div>
                    <div class="rating-count">(${lab.ratingCount} ØªÙ‚ÙŠÙŠÙ…)</div>
                </div>
            </div>
            
            <div style="background: #f8fafc; border-radius: var(--radius-md); padding: 20px; margin: 20px 0;">
                <h4 style="margin-bottom: 15px; color: var(--text-primary);">Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ù…Ø®ØªØ¨Ø±</h4>
                <div style="text-align: right; line-height: 2;">
                    <p><strong>Ø§Ù„Ø¹Ù†ÙˆØ§Ù†:</strong> ${lab.address}</p>
                    <p><strong>Ø§Ù„Ù‡Ø§ØªÙ:</strong> ${lab.phone}</p>
                    <p><strong>Ø³Ø§Ø¹Ø§Øª Ø§Ù„Ø¹Ù…Ù„:</strong> ${lab.workingHours}</p>
                    <p><strong>Ù†Ø·Ø§Ù‚ Ø§Ù„Ø£Ø³Ø¹Ø§Ø±:</strong> ${lab.priceRange}</p>
                    <p><strong>Ø§Ù„Ù…Ø³Ø§ÙØ©:</strong> ${lab.distance}</p>
                </div>
            </div>
            
            <div style="background: #f8fafc; border-radius: var(--radius-md); padding: 20px; margin: 20px 0;">
                <h4 style="margin-bottom: 15px; color: var(--text-primary);">Ø§Ù„Ø®Ø¯Ù…Ø§Øª Ø§Ù„Ù…ØªØ§Ø­Ø©</h4>
                <div style="display: grid; gap: 10px;">
                    ${lab.features.map(feature => `
                        <div style="display: flex; align-items: center; gap: 8px; padding: 10px; background: white; border-radius: var(--radius-sm);">
                            <i class="fas fa-check" style="color: var(--success);"></i>
                            <span>${feature}</span>
                        </div>
                    `).join('')}
                </div>
            </div>
            
            <div class="form-actions">
                <button class="btn btn-secondary" onclick="labSystem.closeModal('labDetailsModal')">
                    <i class="fas fa-times"></i>
                    Ø¥ØºÙ„Ø§Ù‚
                </button>
                <button class="btn btn-primary" onclick="labSystem.closeModal('labDetailsModal'); labSystem.selectLab(${lab.id})">
                    <i class="fas fa-calendar-plus"></i>
                    Ø§Ø­Ø¬Ø² ÙÙŠ Ù‡Ø°Ø§ Ø§Ù„Ù…Ø®ØªØ¨Ø±
                </button>
            </div>
        `;

        this.createModal('labDetailsModal', modalContent);
        this.openModal('labDetailsModal');
    }

    createModal(modalId, content) {
        let modal = document.getElementById(modalId);
        if (!modal) {
            modal = document.createElement('div');
            modal.id = modalId;
            modal.className = 'modal';
            modal.innerHTML = `<div class="modal-content">${content}</div>`;
            document.body.appendChild(modal);
        } else {
            modal.querySelector('.modal-content').innerHTML = content;
        }
    }

    addToCart(testId) {
        const test = this.tests.find(t => t.id === testId);
        if (!test) {
            this.showNotification('Ø§Ù„ØªØ­Ù„ÙŠÙ„ ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯', 'error');
            return;
        }

        // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø¹Ø¯Ù… Ø¥Ø¶Ø§ÙØ© Ø§Ù„ØªØ­Ù„ÙŠÙ„ Ù…Ø³Ø¨Ù‚Ø§Ù‹
        if (this.selectedTests.find(t => t.id === testId)) {
            this.showNotification('ØªÙ… Ø¥Ø¶Ø§ÙØ© Ù‡Ø°Ø§ Ø§Ù„ØªØ­Ù„ÙŠÙ„ Ù…Ø³Ø¨Ù‚Ø§Ù‹', 'info');
            return;
        }

        this.selectedTests.push(test);
        this.showNotification(`ØªÙ… Ø¥Ø¶Ø§ÙØ© ${test.name} Ø¥Ù„Ù‰ Ø³Ù„Ø© Ø§Ù„Ø­Ø¬Ø²`, 'success');
        
        // Ø¥Ø°Ø§ ÙƒØ§Ù† Ù‡Ù†Ø§Ùƒ Ù…Ø®ØªØ¨Ø± Ù…Ø­Ø¯Ø¯ØŒ ÙØªØ­ Ù†Ø§ÙØ°Ø© Ø§Ù„Ø­Ø¬Ø²
        if (this.currentBooking && this.currentBooking.lab) {
            this.openBookModal();
        }
    }

    selectLab(labId) {
        const lab = this.labs.find(l => l.id === labId);
        if (!lab) {
            this.showNotification('Ø§Ù„Ù…Ø®ØªØ¨Ø± ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯', 'error');
            return;
        }

        this.currentBooking = {
            lab: lab,
            tests: [],
            datetime: null,
            address: '',
            notes: ''
        };

        this.showNotification(`ØªÙ… Ø§Ø®ØªÙŠØ§Ø± ${lab.name}`, 'success');
        
        // Ø¥Ø°Ø§ ÙƒØ§Ù†Øª Ù‡Ù†Ø§Ùƒ ØªØ­Ø§Ù„ÙŠÙ„ Ù…Ø­Ø¯Ø¯Ø©ØŒ ÙØªØ­ Ù†Ø§ÙØ°Ø© Ø§Ù„Ø­Ø¬Ø²
        if (this.selectedTests.length > 0) {
            this.openBookModal();
        } else {
            this.showNotification('ÙŠØ±Ø¬Ù‰ Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„ØªØ­Ø§Ù„ÙŠÙ„ Ø£ÙˆÙ„Ø§Ù‹', 'info');
        }
    }

    openBookModal() {
        if (!this.currentBooking || !this.currentBooking.lab) {
            this.showNotification('ÙŠØ±Ø¬Ù‰ Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„Ù…Ø®ØªØ¨Ø± Ø£ÙˆÙ„Ø§Ù‹', 'error');
            return;
        }

        if (this.selectedTests.length === 0) {
            this.showNotification('ÙŠØ±Ø¬Ù‰ Ø§Ø®ØªÙŠØ§Ø± ØªØ­Ù„ÙŠÙ„ ÙˆØ§Ø­Ø¯ Ø¹Ù„Ù‰ Ø§Ù„Ø£Ù‚Ù„', 'error');
            return;
        }

        const totalPrice = this.selectedTests.reduce((sum, test) => sum + test.price, 0);
        const bookingNumber = 'LB-' + new Date().getFullYear() + '-' + String(this.userBookings.length + 1).padStart(3, '0');
        
        const modalContent = `
            <div class="modal-header">
                <div class="modal-title">Ø­Ø¬Ø² ØªØ­Ø§Ù„ÙŠÙ„ Ø·Ø¨ÙŠØ©</div>
                <button class="close-modal" onclick="labSystem.closeModal('bookTestModal')">Ã—</button>
            </div>
            
            <div class="booking-summary">
                <div class="booking-number">${bookingNumber}</div>
                <div class="summary-item">
                    <span class="summary-label">Ø§Ù„Ù…Ø®ØªØ¨Ø±:</span>
                    <span class="summary-value">${this.currentBooking.lab.name}</span>
                </div>
                <div class="summary-item">
                    <span class="summary-label">Ø¹Ø¯Ø¯ Ø§Ù„ØªØ­Ø§Ù„ÙŠÙ„:</span>
                    <span class="summary-value">${this.selectedTests.length}</span>
                </div>
                <div class="summary-item">
                    <span class="summary-label">Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ:</span>
                    <span class="summary-value">${totalPrice} Ø±.ÙŠ</span>
                </div>
            </div>

            <div class="form-group">
                <label class="form-label">ØªØ§Ø±ÙŠØ® ÙˆÙˆÙ‚Øª Ø§Ù„Ø­Ø¬Ø² *</label>
                <input type="datetime-local" class="form-input" id="bookingDateTime" required>
            </div>
            
            <div class="form-group">
                <label class="form-label">Ø§Ù„Ø¹Ù†ÙˆØ§Ù† (Ù„Ø®Ø¯Ù…Ø© Ø§Ù„Ù…Ù†Ø²Ù„) </label>
                <input type="text" class="form-input" id="bookingAddress" placeholder="Ø£Ø¯Ø®Ù„ Ø§Ù„Ø¹Ù†ÙˆØ§Ù† Ø¥Ø°Ø§ ÙƒØ§Ù†Øª Ø§Ù„Ø®Ø¯Ù…Ø© Ù…Ù†Ø²Ù„ÙŠØ©">
            </div>
            
            <div class="form-group">
                <label class="form-label">Ù…Ù„Ø§Ø­Ø¸Ø§Øª Ø¥Ø¶Ø§ÙÙŠØ©</label>
                <textarea class="form-textarea" id="bookingNotes" placeholder="Ù…Ù„Ø§Ø­Ø¸Ø§Øª Ø®Ø§ØµØ© Ø¨Ø§Ù„ØªØ­Ù„ÙŠÙ„..."></textarea>
            </div>
            
            <div style="background: #f8fafc; border-radius: var(--radius-md); padding: 15px; margin: 20px 0;">
                <h4 style="margin-bottom: 10px; color: var(--text-primary);">Ø§Ù„ØªØ­Ø§Ù„ÙŠÙ„ Ø§Ù„Ù…Ø®ØªØ§Ø±Ø©</h4>
                <div style="max-height: 150px; overflow-y: auto;">
                    ${this.selectedTests.map(test => `
                        <div style="display: flex; justify-content: space-between; align-items: center; padding: 8px; border-bottom: 1px solid #e2e8f0;">
                            <span>${test.name}</span>
                            <span style="font-weight: 700; color: var(--primary);">${test.price} Ø±.ÙŠ</span>
                        </div>
                    `).join('')}
                </div>
            </div>
            
            <div class="form-actions">
                <button class="btn btn-secondary" onclick="labSystem.closeModal('bookTestModal')">
                    <i class="fas fa-times"></i>
                    Ø¥Ù„ØºØ§Ø¡
                </button>
                <button class="btn btn-primary" onclick="labSystem.proceedToPayment()">
                    <i class="fas fa-credit-card"></i>
                    Ù…ØªØ§Ø¨Ø¹Ø© Ù„Ù„Ø¯ÙØ¹
                </button>
            </div>
        `;

        document.getElementById('bookTestModal').querySelector('.modal-content').innerHTML = modalContent;
        
        // ØªØ¹ÙŠÙŠÙ† Ø§Ù„ÙˆÙ‚Øª Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠ (Ø¨Ø¹Ø¯ Ø³Ø§Ø¹ØªÙŠÙ† Ù…Ù† Ø§Ù„Ø¢Ù†)
        const now = new Date();
        now.setHours(now.getHours() + 2);
        const defaultDateTime = now.toISOString().slice(0, 16);
        document.getElementById('bookingDateTime').value = defaultDateTime;
        
        this.openModal('bookTestModal');
    }

    proceedToPayment() {
        const datetime = document.getElementById('bookingDateTime').value;
        const address = document.getElementById('bookingAddress').value;
        const notes = document.getElementById('bookingNotes').value;
        
        if (!datetime) {
            this.showNotification('ÙŠØ±Ø¬Ù‰ Ø§Ø®ØªÙŠØ§Ø± ØªØ§Ø±ÙŠØ® ÙˆÙˆÙ‚Øª Ø§Ù„Ø­Ø¬Ø²', 'error');
            return;
        }

        this.currentBooking.datetime = datetime;
        this.currentBooking.address = address;
        this.currentBooking.notes = notes;
        this.currentBooking.tests = [...this.selectedTests];

        // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø±ØµÙŠØ¯ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…
        if (!this.userAccount) {
            this.showNotification('ÙŠØ±Ø¬Ù‰ Ø¥Ù†Ø´Ø§Ø¡ Ø­Ø³Ø§Ø¨ Ù…Ø§Ù„ÙŠ Ø£ÙˆÙ„Ø§Ù‹', 'error');
            setTimeout(() => {
                window.location.href = 'financial.html';
            }, 2000);
            return;
        }

        const totalPrice = this.selectedTests.reduce((sum, test) => sum + test.price, 0);
        
        if (this.userAccount.balance < totalPrice) {
            this.showNotification('Ø±ØµÙŠØ¯Ùƒ ØºÙŠØ± ÙƒØ§ÙÙŠØŒ ÙŠØ±Ø¬Ù‰ Ø´Ø­Ù† Ø§Ù„Ø­Ø³Ø§Ø¨', 'error');
            setTimeout(() => {
                window.location.href = 'financial.html';
            }, 2000);
            return;
        }

        // Ù…Ø¹Ø§Ù„Ø¬Ø© Ø§Ù„Ø­Ø¬Ø²
        this.processBooking();
    }

    processBooking() {
        const totalPrice = this.currentBooking.tests.reduce((sum, test) => sum + test.price, 0);
        const bookingNumber = 'LB-' + new Date().getFullYear() + '-' + String(this.userBookings.length + 1).padStart(3, '0');
        
        const booking = {
            id: bookingNumber,
            lab: this.currentBooking.lab,
            tests: this.currentBooking.tests,
            datetime: this.currentBooking.datetime,
            address: this.currentBooking.address,
            notes: this.currentBooking.notes,
            status: 'confirmed',
            totalPrice: totalPrice,
            createdAt: new Date().toISOString(),
            testNames: this.currentBooking.tests.map(test => test.name).join('ØŒ '),
            labName: this.currentBooking.lab.name
        };

        // ØªØ­Ø¯ÙŠØ« Ø±ØµÙŠØ¯ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…
        if (this.userAccount) {
            this.userAccount.balance -= totalPrice;
            localStorage.setItem('financialAccount', JSON.stringify(this.userAccount));
        }

        // Ø¥Ø¶Ø§ÙØ© Ø¥Ù„Ù‰ Ø³Ø¬Ù„ Ø§Ù„Ø­Ø¬ÙˆØ²Ø§Øª
        this.userBookings.unshift(booking);
        localStorage.setItem('labBookings', JSON.stringify(this.userBookings));

        // Ø¥Ø¶Ø§ÙØ© Ø¥Ù„Ù‰ Ø³Ø¬Ù„ Ø§Ù„Ù…Ø¹Ø§Ù…Ù„Ø§Øª
        this.addToTransactionHistory(booking);

        this.showNotification(`ØªÙ… Ø§Ù„Ø­Ø¬Ø² Ø¨Ù†Ø¬Ø§Ø­: ${totalPrice} Ø±.ÙŠ`, 'success');
        
        // Ø¹Ø±Ø¶ ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø­Ø¬Ø²
        this.showConfirmationModal(booking);
        
        this.closeModal('bookTestModal');
        this.selectedTests = [];
        this.currentBooking = null;
        
        // ØªØ­Ø¯ÙŠØ« Ø¹Ø±Ø¶ Ø§Ù„Ø­Ø¬ÙˆØ²Ø§Øª
        this.renderBookings();
    }

    addToTransactionHistory(booking) {
        const transactions = JSON.parse(localStorage.getItem('financialTransactions')) || [];
        
        const transaction = {
            id: 'TXN' + Date.now(),
            type: 'lab_tests',
            title: `ØªØ­Ø§Ù„ÙŠÙ„ Ø·Ø¨ÙŠØ© ÙÙŠ ${booking.lab.name}`,
            description: `${booking.tests.length} ØªØ­Ù„ÙŠÙ„ - ${booking.testNames}`,
            amount: -booking.totalPrice,
            ref: booking.id,
            date: new Date().toLocaleDateString('ar-EG'),
            time: new Date().toLocaleTimeString('ar-EG'),
            status: 'completed',
            icon: 'icon-lab',
            method: 'wallet',
            lab: booking.lab.name
        };
        
        transactions.unshift(transaction);
        localStorage.setItem('financialTransactions', JSON.stringify(transactions));
    }

    showConfirmationModal(booking) {
        const modalContent = `
            <div class="modal-header">
                <div class="modal-title">ØªÙ… Ø§Ù„Ø­Ø¬Ø² Ø¨Ù†Ø¬Ø§Ø­</div>
                <button class="close-modal" onclick="labSystem.closeModal('confirmationModal')">Ã—</button>
            </div>
            
            <div style="text-align: center; padding: 20px;">
                <div style="font-size: 64px; color: var(--success); margin-bottom: 20px;">
                    <i class="fas fa-check-circle"></i>
                </div>
                <h3 style="margin-bottom: 10px; color: var(--text-primary);">ØªÙ… ØªØ£ÙƒÙŠØ¯ Ø­Ø¬Ø² Ø§Ù„ØªØ­Ø§Ù„ÙŠÙ„</h3>
                <p style="color: var(--text-secondary); margin-bottom: 20px;">Ø³Ù†Ø±Ø³Ù„ Ù„Ùƒ Ø±Ø³Ø§Ù„Ø© ØªØ£ÙƒÙŠØ¯ Ø¨Ø§Ù„ØªÙØ§ØµÙŠÙ„</p>
                
                <div class="booking-number pulse" style="font-size: 18px; margin: 20px 0;">${booking.id}</div>
                
                <div class="booking-summary">
                    <div class="summary-item">
                        <span class="summary-label">Ø§Ù„Ù…Ø®ØªØ¨Ø±:</span>
                        <span class="summary-value">${booking.lab.name}</span>
                    </div>
                    <div class="summary-item">
                        <span class="summary-label">Ø§Ù„ÙˆÙ‚Øª:</span>
                        <span class="summary-value">${new Date(booking.datetime).toLocaleString('ar-EG')}</span>
                    </div>
                    <div class="summary-item">
                        <span class="summary-label">Ø¹Ø¯Ø¯ Ø§Ù„ØªØ­Ø§Ù„ÙŠÙ„:</span>
                        <span class="summary-value">${booking.tests.length}</span>
                    </div>
                    <div class="summary-item">
                        <span class="summary-label">Ø§Ù„Ù…Ø¨Ù„Øº:</span>
                        <span class="summary-value">${booking.totalPrice} Ø±.ÙŠ</span>
                    </div>
                </div>
            </div>
            
            <div class="form-actions">
                <button class="btn btn-primary" onclick="labSystem.closeModal('confirmationModal')">
                    <i class="fas fa-check"></i>
                    Ø­Ø³Ù†Ø§Ù‹
                </button>
            </div>
        `;

        document.getElementById('confirmationModal').querySelector('.modal-content').innerHTML = modalContent;
        this.openModal('confirmationModal');
    }

    showBookingDetails(booking) {
        const modalContent = `
            <div class="modal-header">
                <div class="modal-title">ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ø­Ø¬Ø²</div>
                <button class="close-modal" onclick="labSystem.closeModal('bookingDetailsModal')">Ã—</button>
            </div>
            
            <div class="booking-summary">
                <div class="booking-number">${booking.id}</div>
                <div class="summary-item">
                    <span class="summary-label">Ø§Ù„Ø­Ø§Ù„Ø©:</span>
                    <span class="summary-value" style="color: ${this.getStatusColor(booking.status)}">${this.getStatusText(booking.status)}</span>
                </div>
                <div class="summary-item">
                    <span class="summary-label">Ø§Ù„Ù…Ø®ØªØ¨Ø±:</span>
                    <span class="summary-value">${booking.labName}</span>
                </div>
                <div class="summary-item">
                    <span class="summary-label">Ø§Ù„ØªØ§Ø±ÙŠØ®:</span>
                    <span class="summary-value">${new Date(booking.datetime).toLocaleDateString('ar-EG')}</span>
                </div>
                <div class="summary-item">
                    <span class="summary-label">Ø§Ù„ÙˆÙ‚Øª:</span>
                    <span class="summary-value">${new Date(booking.datetime).toLocaleTimeString('ar-EG')}</span>
                </div>
                <div class="summary-item">
                    <span class="summary-label">Ø§Ù„Ù…Ø¨Ù„Øº:</span>
                    <span class="summary-value">${booking.totalPrice} Ø±.ÙŠ</span>
                </div>
            </div>

            <div style="background: #f8fafc; border-radius: var(--radius-md); padding: 20px; margin: 20px 0;">
                <h4 style="margin-bottom: 15px; color: var(--text-primary);">Ø§Ù„ØªØ­Ø§Ù„ÙŠÙ„ Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©</h4>
                <div style="max-height: 200px; overflow-y: auto;">
                    ${booking.tests.map(test => `
                        <div style="display: flex; justify-content: space-between; align-items: center; padding: 10px; border-bottom: 1px solid #e2e8f0;">
                            <div>
                                <div style="font-weight: 600;">${test.name}</div>
                                <div style="font-size: 12px; color: var(--text-secondary);">${test.description}</div>
                            </div>
                            <div style="font-weight: 700; color: var(--primary);">${test.price} Ø±.ÙŠ</div>
                        </div>
                    `).join('')}
                </div>
            </div>
            
            ${booking.address ? `
                <div style="background: #f8fafc; border-radius: var(--radius-md); padding: 15px; margin: 20px 0;">
                    <h4 style="margin-bottom: 10px; color: var(--text-primary);">Ø§Ù„Ø¹Ù†ÙˆØ§Ù†</h4>
                    <p>${booking.address}</p>
                </div>
            ` : ''}
            
            ${booking.notes ? `
                <div style="background: #f8fafc; border-radius: var(--radius-md); padding: 15px; margin: 20px 0;">
                    <h4 style="margin-bottom: 10px; color: var(--text-primary);">Ù…Ù„Ø§Ø­Ø¸Ø§Øª</h4>
                    <p>${booking.notes}</p>
                </div>
            ` : ''}
            
            <div class="form-actions">
                <button class="btn btn-secondary" onclick="labSystem.closeModal('bookingDetailsModal')">
                    <i class="fas fa-times"></i>
                    Ø¥ØºÙ„Ø§Ù‚
                </button>
                ${booking.status === 'completed' ? 
                    `<button class="btn btn-primary" onclick="labSystem.closeModal('bookingDetailsModal'); labSystem.showResults('${booking.id}')">
                        <i class="fas fa-file-medical"></i>
                        Ø¹Ø±Ø¶ Ø§Ù„Ù†ØªØ§Ø¦Ø¬
                    </button>` : ''
                }
            </div>
        `;

        this.createModal('bookingDetailsModal', modalContent);
        this.openModal('bookingDetailsModal');
    }

    showResults(bookingId) {
        const booking = this.userBookings.find(b => b.id === bookingId);
        if (!booking) {
            this.showNotification('Ø§Ù„Ø­Ø¬Ø² ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯', 'error');
            return;
        }

        // Ù…Ø­Ø§ÙƒØ§Ø© Ù†ØªØ§Ø¦Ø¬ Ø§Ù„ØªØ­Ø§Ù„ÙŠÙ„
        const results = this.generateMockResults(booking.tests);
        
        const modalContent = `
            <div class="modal-header">
                <div class="modal-title">Ù†ØªØ§Ø¦Ø¬ Ø§Ù„ØªØ­Ø§Ù„ÙŠÙ„</div>
                <button class="close-modal" onclick="labSystem.closeModal('resultsModal')">Ã—</button>
            </div>
            
            <div class="booking-summary">
                <div class="booking-number">${booking.id}</div>
                <div class="summary-item">
                    <span class="summary-label">Ø§Ù„Ù…Ø®ØªØ¨Ø±:</span>
                    <span class="summary-value">${booking.labName}</span>
                </div>
                <div class="summary-item">
                    <span class="summary-label">ØªØ§Ø±ÙŠØ® Ø§Ù„Ù†ØªØ§Ø¦Ø¬:</span>
                    <span class="summary-value">${new Date().toLocaleDateString('ar-EG')}</span>
                </div>
            </div>

            <div class="results-container">
                <h4 style="margin-bottom: 15px; color: var(--text-primary);">Ù†ØªØ§Ø¦Ø¬ Ø§Ù„ØªØ­Ø§Ù„ÙŠÙ„</h4>
                ${results.map(result => `
                    <div class="result-item">
                        <div class="result-name">${result.name}</div>
                        <div class="result-value ${result.status}">${result.value}</div>
                        <div class="result-range">${result.range}</div>
                        <div class="result-status status-${result.status}">${result.statusText}</div>
                    </div>
                `).join('')}
            </div>

            <div style="background: #f8fafc; border-radius: var(--radius-md); padding: 15px; margin: 20px 0;">
                <h4 style="margin-bottom: 10px; color: var(--text-primary);">Ø§Ù„ØªÙˆØµÙŠØ§Øª</h4>
                <p>${this.generateRecommendations(results)}</p>
            </div>
            
            <div class="form-actions">
                <button class="btn btn-secondary" onclick="labSystem.closeModal('resultsModal')">
                    <i class="fas fa-times"></i>
                    Ø¥ØºÙ„Ø§Ù‚
                </button>
                <button class="btn btn-primary" onclick="labSystem.downloadResults('${bookingId}')">
                    <i class="fas fa-download"></i>
                    ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù†ØªØ§Ø¦Ø¬
                </button>
            </div>
        `;

        document.getElementById('resultsModal').querySelector('.modal-content').innerHTML = modalContent;
        this.openModal('resultsModal');
    }

    generateMockResults(tests) {
        const results = [];
        
        tests.forEach(test => {
            // Ù…Ø­Ø§ÙƒØ§Ø© Ù†ØªØ§Ø¦Ø¬ Ù…Ø®ØªÙ„ÙØ© Ù„ÙƒÙ„ ØªØ­Ù„ÙŠÙ„
            const status = Math.random() > 0.7 ? 'warning' : Math.random() > 0.9 ? 'danger' : 'normal';
            const statusText = status === 'normal' ? 'Ø·Ø¨ÙŠØ¹ÙŠ' : status === 'warning' ? 'Ø§Ù†ØªØ¨Ø§Ù‡' : 'ØºÙŠØ± Ø·Ø¨ÙŠØ¹ÙŠ';
            
            let value, range;
            
            switch(test.name) {
                case 'ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ø¯Ù… Ø§Ù„Ø´Ø§Ù…Ù„':
                    value = '5.2 Ù…Ù„ÙŠÙˆÙ†/Ù…Ù…Â³';
                    range = '4.5-6.0 Ù…Ù„ÙŠÙˆÙ†/Ù…Ù…Â³';
                    break;
                case 'ØªØ­Ù„ÙŠÙ„ ÙˆØ¸Ø§Ø¦Ù Ø§Ù„ÙƒØ¨Ø¯':
                    value = '25 ÙˆØ­Ø¯Ø©/Ù„ØªØ±';
                    range = '10-40 ÙˆØ­Ø¯Ø©/Ù„ØªØ±';
                    break;
                case 'ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ø³ÙƒØ± Ø§Ù„ØªØ±Ø§ÙƒÙ…ÙŠ':
                    value = '5.4%';
                    range = 'Ø£Ù‚Ù„ Ù…Ù† 5.7%';
                    break;
                case 'ØªØ­Ù„ÙŠÙ„ ÙÙŠØªØ§Ù…ÙŠÙ† Ø¯':
                    value = '35 Ù†Ø§Ù†ÙˆØºØ±Ø§Ù…/Ù…Ù„';
                    range = '30-100 Ù†Ø§Ù†ÙˆØºØ±Ø§Ù…/Ù…Ù„';
                    break;
                case 'ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ø¨ÙˆÙ„ Ø§Ù„ÙƒØ§Ù…Ù„':
                    value = 'Ø³Ù„Ø¨ÙŠ';
                    range = 'Ø³Ù„Ø¨ÙŠ';
                    break;
                case 'ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ø¯Ù‡ÙˆÙ†':
                    value = '180 Ù…Ù„Øº/Ø¯Ù„';
                    range = 'Ø£Ù‚Ù„ Ù…Ù† 200 Ù…Ù„Øº/Ø¯Ù„';
                    break;
                default:
                    value = 'Ø¶Ù…Ù† Ø§Ù„Ù…Ø¹Ø¯Ù„';
                    range = 'Ø·Ø¨ÙŠØ¹ÙŠ';
            }
            
            results.push({
                name: test.name,
                value: value,
                range: range,
                status: status,
                statusText: statusText
            });
        });
        
        return results;
    }

    generateRecommendations(results) {
        const abnormalResults = results.filter(r => r.status !== 'normal');
        
        if (abnormalResults.length === 0) {
            return 'Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù†ØªØ§Ø¦Ø¬ Ø¶Ù…Ù† Ø§Ù„Ù…Ø¹Ø¯Ù„ Ø§Ù„Ø·Ø¨ÙŠØ¹ÙŠ. Ø­Ø§ÙØ¸ Ø¹Ù„Ù‰ Ù†Ù…Ø· Ø­ÙŠØ§ØªÙƒ Ø§Ù„ØµØ­ÙŠ.';
        }
        
        if (abnormalResults.some(r => r.status === 'danger')) {
            return 'ÙŠÙˆØ¬Ø¯ Ø¨Ø¹Ø¶ Ø§Ù„Ù†ØªØ§Ø¦Ø¬ Ø§Ù„ØªÙŠ ØªØ­ØªØ§Ø¬ Ø¥Ù„Ù‰ Ù…ØªØ§Ø¨Ø¹Ø© Ø·Ø¨ÙŠØ© Ø¹Ø§Ø¬Ù„Ø©. ÙŠØ±Ø¬Ù‰ Ù…Ø±Ø§Ø¬Ø¹Ø© Ø·Ø¨ÙŠØ¨Ùƒ Ø§Ù„Ø®Ø§Øµ.';
        }
        
        return 'ÙŠÙˆØ¬Ø¯ Ø¨Ø¹Ø¶ Ø§Ù„Ù†ØªØ§Ø¦Ø¬ Ø§Ù„ØªÙŠ ØªØ­ØªØ§Ø¬ Ø¥Ù„Ù‰ Ù…ØªØ§Ø¨Ø¹Ø©. Ù†Ù†ØµØ­ Ø¨Ù…Ø±Ø§Ø¬Ø¹Ø© Ø·Ø¨ÙŠØ¨Ùƒ Ù„Ù„Ù…Ù†Ø§Ù‚Ø´Ø© ÙˆØ§Ù„ØªÙˆØ¬ÙŠÙ‡.';
    }

    downloadResults(bookingId) {
        this.showNotification('Ø¬Ø§Ø±ÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù†ØªØ§Ø¦Ø¬...', 'info');
        
        // Ù…Ø­Ø§ÙƒØ§Ø© Ø¹Ù…Ù„ÙŠØ© Ø§Ù„ØªØ­Ù…ÙŠÙ„
        setTimeout(() => {
            this.showNotification('ØªÙ… ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù†ØªØ§Ø¦Ø¬ Ø¨Ù†Ø¬Ø§Ø­', 'success');
        }, 2000);
    }

    cancelBooking(bookingId) {
        const booking = this.userBookings.find(b => b.id === bookingId);
        if (!booking) {
            this.showNotification('Ø§Ù„Ø­Ø¬Ø² ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯', 'error');
            return;
        }

        if (booking.status !== 'pending') {
            this.showNotification('Ù„Ø§ ÙŠÙ…ÙƒÙ† Ø¥Ù„ØºØ§Ø¡ Ù‡Ø°Ø§ Ø§Ù„Ø­Ø¬Ø²', 'error');
            return;
        }

        if (confirm('Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø¥Ù„ØºØ§Ø¡ Ù‡Ø°Ø§ Ø§Ù„Ø­Ø¬Ø²ØŸ')) {
            booking.status = 'cancelled';
            localStorage.setItem('labBookings', JSON.stringify(this.userBookings));
            
            // Ø§Ø³ØªØ¹Ø§Ø¯Ø© Ø§Ù„Ø±ØµÙŠØ¯
            if (this.userAccount) {
                this.userAccount.balance += booking.totalPrice;
                localStorage.setItem('financialAccount', JSON.stringify(this.userAccount));
            }
            
            this.showNotification('ØªÙ… Ø¥Ù„ØºØ§Ø¡ Ø§Ù„Ø­Ø¬Ø² Ø¨Ù†Ø¬Ø§Ø­', 'success');
            this.renderBookings();
        }
    }

    getStatusColor(status) {
        const colors = {
            'pending': '#f59e0b',
            'confirmed': '#059669',
            'completed': '#0ea5e9',
            'cancelled': '#dc2626'
        };
        return colors[status] || '#64748b';
    }

    openModal(modalId) {
        const modal = document.getElementById(modalId);
        if (modal) {
            modal.style.display = 'flex';
            document.body.style.overflow = 'hidden';
        }
    }

    closeModal(modalId) {
        const modal = document.getElementById(modalId);
        if (modal) {
            modal.style.display = 'none';
            document.body.style.overflow = 'auto';
        }
    }

    showNotification(message, type = 'info') {
        const notification = document.createElement('div');
        notification.className = `notification ${type}`;
        notification.innerHTML = `
            <i class="fas ${type === 'success' ? 'fa-check-circle' : type === 'error' ? 'fa-exclamation-circle' : 'fa-info-circle'}"></i>
            ${message}
        `;
        
        document.body.appendChild(notification);
        
        setTimeout(() => {
            if (notification.parentNode) {
                notification.parentNode.removeChild(notification);
            }
        }, 4000);
    }

    updateTime() {
        const now = new Date();
        const timeString = now.toLocaleTimeString('ar-EG', { 
            hour: '2-digit', 
            minute: '2-digit',
            hour12: true 
        });
        
        const timeElement = document.getElementById('currentTime');
        if (timeElement) {
            timeElement.textContent = timeString;
        }
    }
}

// ØªÙ‡ÙŠØ¦Ø© Ø§Ù„Ù†Ø¸Ø§Ù… Ø¹Ù†Ø¯ ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØµÙØ­Ø©
document.addEventListener('DOMContentLoaded', function() {
    window.labSystem = new AdvancedLabSystem();
    
    // ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø­Ø¬ÙˆØ²Ø§Øª Ø¨Ø¹Ø¯ Ø§Ù„ØªÙ‡ÙŠØ¦Ø©
    setTimeout(() => {
        window.labSystem.renderBookings();
    }, 1000);
});

// Ø¬Ø¹Ù„ Ø§Ù„Ù†Ø¸Ø§Ù… Ù…ØªØ§Ø­Ø§Ù‹ globally
window.AdvancedLabSystem = AdvancedLabSystem;
</script>
</body>
</html>